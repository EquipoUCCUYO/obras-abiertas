"use strict";angular.module("obrasMduytApp",["ngRoute","ngSanitize","slugifier","angular-flexslider","leaflet-directive"]).config(["$routeProvider",function(a){a.when("/home",{templateUrl:"views/home.html",controller:"HomeCtrl",controllerAs:"home"}).when("/obra/:id",{templateUrl:"views/obra.html",controller:"ObraCtrl",controllerAs:"obra"}).when("/entorno/:entorno",{templateUrl:"views/entorno.html",controller:"EntornoCtrl",controllerAs:"entorno"}).otherwise({redirectTo:"/home"})}]).service("DataService",["$http","$q","Slug",function(a,b,c){var d,e=function(a){a.entorno_slug=a.entorno?c.slugify(a.entorno):null,a.etapa_slug=a.etapa?c.slugify(a.etapa):null,a.tipo_slug=a.tipo?c.slugify(a.tipo):null,a.comuna=a.comuna?a.comuna.split("|"):[],a.barrio=a.barrio?a.barrio.split("|"):[],a.licitacion_oferta_empresas=a.licitacion_oferta_empresas?a.licitacion_oferta_empresas.split("|"):[],a.id=parseInt(a.id),a.licitacion_anio=a.licitacion_anio?parseInt(a.licitacion_anio.trim()):null,a.monto_contrato=a.monto_contrato?parseFloat(a.monto_contrato.trim()):null,a.licitacion_presupuesto_oficial=a.licitacion_presupuesto_oficial?parseFloat(a.licitacion_presupuesto_oficial.trim()):null,a.plazo_meses=a.plazo_meses?parseInt(a.plazo_meses.trim()):null,a.porcentaje_avance=a.porcentaje_avance?parseFloat(a.porcentaje_avance.trim()):null,a.fotos=[];for(var b=1;4>=b;b++){var d="imagen_"+b;a[d]&&a.fotos.push(a[d])}return a},f=["en-proyecto","en-licitacion","en-ejecucion","finalizada"],g=function(a){var b=f.indexOf(a.etapa_slug)>-1;return b},h=function(){return window.MDUYT_CONFIG||(console.error("Archivo de configuración inexistente, utilizando configuración default de desarrollo."),window.MDUYT_CONFIG={BASE_URL:"http://api.topranking.link/",HOME_CSV:"https://goo.gl/vcb6oX"}),window.MDUYT_CONFIG.BASE_URL+"?source_format=csv&source="+window.MDUYT_CONFIG.HOME_CSV+"&callback=JSON_CALLBACK"};this.getById=function(a){var c,d=b.defer();return this.retrieveAll().then(function(b){c=b.filter(function(b){return b.id===parseInt(a)}),d.resolve(c[0])}),c=d.promise,b.when(c)},this.getByEntorno=function(a){var c,d=b.defer();return this.retrieveAll().then(function(b){c=b.filter(function(b){return b.entorno_slug===a}),d.resolve(c)}),c=d.promise,b.when(c)},this.getAll=function(){var a,c=b.defer();return this.retrieveAll().then(function(a){c.resolve(a)}),a=c.promise,b.when(a)},this.retrieveAll=function(){if(!d){var c=b.defer();a.jsonp(h()).then(function(a){d=a.data.map(e).filter(g),c.resolve(d)},function(a){d=a,c.reject(a)}),d=c.promise}return b.when(d)}}]).run(function(){}),angular.module("obrasMduytApp").controller("HomeCtrl",["$scope","DataService","$filter",function(a,b,c){function d(){y.w=x.select("#home-chart-container").node().getBoundingClientRect().width,y.w=!y.svg||y.w<500?y.w-15:y.w,a.isSmallDevice=y.w<700?!0:!1,a.isSmallDevice?(y.h=y.w,y.margin=y.w/100):(y.h=3*y.w/4,y.margin=y.w/200),y.svg||(y.svg=x.select("#home-chart-container").append("svg"),y.mainGroup=y.svg.append("g").classed("main-group",!0),y.mainGroup.append("rect").attr("fill","white"),y.svg.append("g").attr("id","comunas-group"),y.svg.append("g").attr("id","map-group"),y.svg.append("g").attr("id","etapas-group"),B.group=y.svg.append("g").attr("id","bubbles-group")),y.svg.attr("width",y.w).attr("height",y.h),y.mainGroup.select("rect").attr("width",y.w).attr("height",y.h),a.showGroup(a.selectedGroup)}function e(){z.w=x.select("#side-chart-container").node().getBoundingClientRect().width,z.h=400,z.margin=z.w/100,z.gap=2,z.svg||(z.svg=x.select("#side-chart-container").append("svg"),z.mainGroup=z.svg.append("g").classed("main-group",!0),z.mainGroup.append("rect").attr("fill","white")),z.scale=x.scale.linear().domain([0,a.obras.length]).range([0,z.h-(a.total_obras_by_tipo.length-1)*z.gap]),z.svg.attr("width",z.w).attr("height",z.h),z.mainGroup.select("rect").attr("width",z.w).attr("height",z.h),z.groups=z.mainGroup.selectAll("g.tipo-group").data(a.total_obras_by_tipo),z.groups.enter().append("g").attr("id",function(a){return"tipo-group-"+a.slug}).classed("tipo-group",!0).each(function(a){var b=x.select(this);b.append("rect").datum(a).classed("tipo-rect",!0).attr("fill",function(a){return C(a.tipo)}).on("mouseover",function(){console.log(a)}),b.append("text").datum(a).classed("tipo-text",!0).attr("fill","#000").attr("x",30).text(function(){return a.tipo})}),z.groups.selectAll("rect.tipo-rect").attr("width",20).attr("height",function(a){return z.scale(a.candidad)}),z.groups.selectAll("text.tipo-text").attr("y",function(a){return z.scale(a.candidad)/2+5});var b=0;z.groups.transition().attr("transform",function(a){var c=b;return b=b+z.gap+z.scale(a.candidad),"translate(0,"+c+")"})}function f(){A.w=x.select("#scale-chart-container").node().getBoundingClientRect().width,A.h=300,A.margin=A.w/100,A.gap=5,A.svg||(A.svg=x.select("#scale-chart-container").append("svg"),A.mainGroup=A.svg.append("g").classed("main-group",!0),A.mainGroup.append("rect").attr("fill","white"));var a;if(B.scale){var b=(B.scale.domain(),B.scale.range());a=[{legend:"Más de 2",radius:b[1]},{legend:"Entre 1 y 2",radius:(b[0]+b[1])/2},{legend:"Hasta 1",radius:b[0]}]}else a=[{legend:"Obra",radius:10}];A.groups=A.mainGroup.selectAll("g.legend-group").data(a),A.groups.enter().append("g").attr("id",function(a,b){return"legend-group-"+b}).classed("legend-group",!0).each(function(a){var b=x.select(this);b.append("circle").datum(a).classed("legend-circle",!0).attr("fill","ccc"),b.append("text").datum(a).classed("legend-text",!0).attr("fill","#000")}),A.groups.each(function(a){var b=x.select(this);b.select("circle").datum(a),b.select("text").datum(a)}),A.groups.exit().remove();var c=0;A.groups.transition().attr("transform",function(a){var b=c;return c+=A.gap+2*a.radius,"translate(0,"+b+")"});var d=x.max(a,function(a){return a.radius});A.groups.selectAll("circle.legend-circle").attr("cy",function(a){return a.radius}).attr("cx",function(a){return d}).attr("r",function(a){return a.radius}),A.groups.selectAll("text.legend-text").attr("x",function(a){return 2*d+10}).attr("y",function(a){return a.radius+5}).text(function(a){return a.legend}),A.svg.attr("width",A.w).attr("height",c),A.mainGroup.select("rect").attr("width",A.w).attr("height",c)}function g(a,b,c){var d=Math.floor(y.w/b),e=0,f=0;a.transition().duration(700).attr("transform",function(g,h){var i=e*b,j=f*c;return d-1>e?e++:a[0].length!==h+1&&(e=0,f++),"translate("+i+","+j+")"})}function h(){function b(){a.isSmallDevice&&y.svg.attr("height",y.w),y.mapGroup.selectAll("path.map-item").style("display","block").style("stroke-width",0).transition().duration(1e3).style("stroke-width",3).attr("d",y.mapPath).style("opacity",1)}y.mapProjection=x.geo.mercator().center([-58.43992,-34.618]).translate([y.w/2,y.h/2]).scale(190*y.w),y.mapPath=x.geo.path().projection(y.mapProjection),y.mapGroup?b():(y.mapGroup=y.svg.select("#map-group"),x.json("geo/comunas.simple.geojson",function(a){y.mapCentroids={},y.mapFeatures=a.features,H.each(y.mapFeatures,function(a){y.mapCentroids["mapa-comuna-"+a.properties.comuna]=y.mapPath.centroid(a)}),y.mapGroup.selectAll("path.map-item").data(y.mapFeatures).enter().append("path").classed("child",!0).classed("map-item",!0).attr("id",function(a){return"mapa-comuna-"+a.properties.comuna}).classed("shape",!0).on("click",j),b()}))}function i(){B.clusters={},B.clusterPoints={},B.nodesComuna=[],B.nodes=a.obras.filter(function(a){return a.lat&&a.lng}).map(function(a){var b="i"+a.id,c=5,d={cluster:b,radius:c,data:a};B.clusters[b]=d;var e=y.mapProjection([parseFloat(a.lng),parseFloat(a.lat)]);return B.clusterPoints[b]={x:e[0],y:e[1],radius:5},a.comuna.length>1&&H.each(a.comuna,function(a){var b=H.clone(d);b.comuna=a,B.nodesComuna.push(b)}),d}),B.scale=!1,f()}function j(b){if(a.closeTooltip(),I.node()===this)return k();I.classed("active",!1),I=x.select(this).classed("active",!0);var c=y.mapPath.bounds(b),d=c[1][0]-c[0][0],e=c[1][1]-c[0][1],f=(c[0][0]+c[1][0])/2,g=(c[0][1]+c[1][1])/2,h=.9/Math.max(d/y.w,e/y.h),i=[y.w/2-h*f,y.h/2-h*g];y.mapGroup.transition().duration(750).attr("transform","translate("+i+")scale("+h+")"),y.mapGroup.selectAll("path").transition().duration(750).style("stroke-width","1px"),B.group.transition().duration(750).attr("transform","translate("+i+")scale("+h+")")}function k(){I.classed("active",!1),I=x.select(null),y.mapGroup.transition().duration(750).attr("transform",""),y.mapGroup.selectAll("path").transition().duration(750).style("stroke-width","3px"),B.group.transition().duration(750).attr("transform","")}function l(b){var c,d,e=x.range(1,16);a.isSmallDevice?(c=y.w,d=y.w,y.svg.attr("height",e.length*y.w),y.mainGroup.select("rect").attr("height",e.length*y.w)):(c=y.h/3,d=y.w/5),y.comunasGroup||(y.comunasGroup=y.svg.select("#comunas-group"),y.comunasGroup.selectAll("g.comunas-item").data(e).enter().append("g").classed("child",!0).classed("comunas-item",!0).style("opacity",0).attr("transform",function(a,b){return"translate("+(y.w/2-d/2)+","+(y.h/2-c/2)+")"}).attr("id",function(a){return"comunas-item-"+a}).each(function(){var a=x.select(this);a.append("rect").classed("comunas-item-frame",!0).on("click",n),a.append("text").classed("comunas-item-text",!0).attr("fill","#000").text(function(a){return"Comuna "+a})})),b||y.comunasGroup.selectAll("g.comunas-item").style("display","block"),y.comunasGroup.selectAll("rect.comunas-item-frame").transition().duration(700).attr("x",y.margin).attr("y",y.margin).attr("height",c-2*y.margin).attr("width",d-2*y.margin),y.comunasGroup.selectAll("text.comunas-item-text").transition().duration(700).attr("x",15).attr("y",25),g(y.comunasGroup.selectAll("g.comunas-item").transition().duration(1e3).style("opacity",1),d,c)}function m(b){B.clusters={},B.clusterPoints={},B.nodesComuna=[];var c=b?b.replace("comunas-item-",""):!1,d=a.obras.filter(function(a){return a.comuna[0]&&(!c||c&&a.comuna[0]===c)}),e=Math.ceil(x.max(d,function(a){return a.monto_contrato})),g=Math.floor(x.min(d,function(a){return a.monto_contrato}));B.scale=x.scale.linear().domain([parseInt(g),parseInt(e)]).range([10,c?100:50]),f(),B.nodes=d.filter(function(a){return a.comuna[0]&&(!c||c&&a.comuna[0]===c)}).map(function(a){var b="c"+a.comuna[0],c=B.scale(a.monto_contrato?a.monto_contrato:0),d={cluster:b,radius:c?c:10,data:a};return(!B.clusters[b]||c>B.clusters[b].radius)&&(B.clusters[b]=d),d}),x.selectAll("g.comunas-item").each(function(a){var b=x.select(this),c=b.select("rect");B.clusterPoints["c"+a]={x:x.transform(b.attr("transform")).translate[0]+c.attr("width")/2,y:x.transform(b.attr("transform")).translate[1]+c.attr("height")/2,radius:20}})}function n(b){if(a.closeTooltip(),J.node()===this)return o();J.classed("active",!1),J=x.select(this).classed("active",!0);var c=J.node().parentNode;x.selectAll("g.comunas-item").transition().style("opacity",function(){return this===c?1:0}).each("end",function(){this!==c&&x.select(this).style("display","none")}),J.transition().duration(750).attr("height",y.h-2*y.margin).attr("width",y.w-2*y.margin),x.select(c).transition().duration(750).attr("transform","translate(0,0)").each("end",function(){m(x.select(c).attr("id")),t()})}function o(a){J.classed("active",!1),J=x.select(null),x.selectAll("g.comunas-item").style("display","block"),l(a),a||setTimeout(function(){m(),t()},2e3)}function p(b){var c,d,e=["en-proyecto","en-licitacion","en-ejecucion","finalizada"],f={"en-proyecto":"En Proyecto","en-licitacion":"En Licitación","en-ejecucion":"En Ejecución",finalizada:"Finalizada"};a.isSmallDevice?(c=y.w,d=y.w,y.svg.attr("height",e.length*y.w),y.mainGroup.select("rect").attr("height",e.length*y.w)):(c=y.h/2,d=y.w/2),y.etapasGroup||(y.etapasGroup=y.svg.select("#etapas-group"),y.etapasGroup.selectAll("g.etapas-item").data(e).enter().append("g").classed("child",!0).classed("etapas-item",!0).style("opacity",0).attr("transform",function(a,b){return"translate("+(y.w/2-d/2)+","+(y.h/2-c/2)+")"}).attr("id",function(a){return"etapas-item-"+a}).each(function(){var a=x.select(this);a.append("rect").classed("etapas-item-frame",!0).on("click",s),a.append("text").classed("etapas-item-text",!0).attr("fill","#000").text(function(a){return f[a]})})),b||y.etapasGroup.selectAll("g.etapas-item").style("display","block"),y.etapasGroup.selectAll("rect.etapas-item-frame").transition().duration(700).attr("x",y.margin).attr("y",y.margin).attr("height",c-2*y.margin).attr("width",d-2*y.margin),y.etapasGroup.selectAll("text.etapas-item-text").transition().duration(700).attr("x",15).attr("y",25),g(y.etapasGroup.selectAll("g.etapas-item").transition().duration(1e3).style("opacity",1),d,c)}function q(b){B.clusters={},B.clusterPoints={},B.nodesComuna=[];var c=b?b.replace("etapas-item-",""):!1,d=a.obras.filter(function(a){return a.etapa&&(!c||c&&a.etapa_slug===c)}),e=Math.ceil(x.max(d,function(a){return a.monto_contrato})),g=Math.floor(x.min(d,function(a){return a.monto_contrato}));B.scale=x.scale.linear().domain([parseInt(g),parseInt(e)]).range([10,c?100:50]),f(),B.nodes=d.map(function(a){var b="e-"+a.etapa_slug,c=B.scale(a.monto_contrato?a.monto_contrato:10),d={cluster:b,radius:c?c:10,data:a};return(!B.clusters[b]||c>B.clusters[b].radius)&&(B.clusters[b]=d),d}),c?B.clusterPoints=!1:x.selectAll("g.etapas-item").each(function(a){var b=x.select(this),c=b.select("rect");B.clusterPoints["e-"+a]={x:x.transform(b.attr("transform")).translate[0]+c.attr("width")/2,y:x.transform(b.attr("transform")).translate[1]+c.attr("height")/2,radius:10}})}function r(a){K.classed("active",!1),K=x.select(null),x.selectAll("g.etapas-item").style("display","block"),p(a),a||setTimeout(function(){q(),t()},2e3)}function s(b){if(a.closeTooltip(),K.node()===this)return r();K.classed("active",!1),K=x.select(this).classed("active",!0);var c=K.node().parentNode;x.selectAll("g.etapas-item").transition().style("opacity",function(){return this===c?1:0}).each("end",function(){this!==c&&x.select(this).style("display","none")}),K.transition().duration(750).attr("height",y.h-2*y.margin).attr("width",y.w-2*y.margin),x.select(c).transition().duration(750).attr("transform","translate(0,0)").each("end",function(){q(x.select(c).attr("id")),t()})}function t(){B.force=x.layout.force().nodes(B.nodes).size([y.w,y.h]).gravity(0).charge(1).on("tick",u).start(),B.circles=B.group.selectAll("circle.obra").data(B.nodes),B.circles.enter().append("circle").classed("obra",!0).on("click",function(b){a.selectedObra=b,a.$apply(),a.tooltip.transition().duration(200).style("left",x.event.pageX+"px").style("top",x.event.pageY-28+"px").style("opacity",1)}),B.circles.attr("id",function(a){return"e"+a.data.id}).style("fill",function(a){return C(a.data.tipo)}),B.circles.transition().style("opacity",1).attr("r",function(a){return a.radius}),B.circles.exit().remove(),B.circles.each(function(a){})}function u(a){B.circles.each(v(10*a.alpha*a.alpha)).each(w(.5)).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y})}function v(a){return function(b){var c=B.clusters[b.cluster],d=1;if(c){c===b&&(B.clusterPoints?(c=B.clusterPoints[b.cluster],c={x:c.x,y:c.y,radius:-c.radius},d=.5*Math.sqrt(b.radius)):(c={x:y.w/2,y:y.h/2,radius:-b.radius},d=.1*Math.sqrt(b.radius)));var e=b.x-c.x,f=b.y-c.y,g=Math.sqrt(e*e+f*f),h=b.radius+c.radius;g!==h&&(g=(g-h)/g*a*d,b.x-=e*=g,b.y-=f*=g,c.x+=e,c.y+=f)}}}function w(a){var b=x.geom.quadtree(B.nodes);return function(c){var d=c.radius+2,e=c.x-d,f=c.x+d,g=c.y-d,h=c.y+d;b.visit(function(b,d,i,j,k){if(b.point&&b.point!==c){var l=c.x-b.point.x,m=c.y-b.point.y,n=Math.sqrt(l*l+m*m),o=c.radius+b.point.radius+2;o>n&&(n=(n-o)/n*a,c.x-=l*=n,c.y-=m*=n,b.point.x+=l,b.point.y+=m)}return d>f||e>j||i>h||g>k})}}var x=window.d3;a.pymChild=new window.pym.Child({polling:1e3});var y={},z={},A={},B={},C=x.scale.category20();a.selectedGroup="comunas",a.selectedObra=!1,a.tooltip=x.select("#tooltip-home-chart");var D={comunas:l,etapas:p,map:h},E={comunas:m,etapas:q,map:i},F={comunas:o,etapas:r,map:k},G={comunas:!1,etapas:!1,map:!1},H=window._;b.getAll().then(function(b){a.obras=b,a.obras_by_tipo=H.groupBy(b,"tipo"),a.tipo_keys=H.keys(a.obras_by_tipo),a.total_obras_by_tipo=H.reduce(a.obras_by_tipo,function(a,b,c){return a.push({tipo:c,slug:b[0].tipo_slug,candidad:b.length}),a},[]),e(),d(),window.$(window).resize(function(){clearTimeout(a.timeoutId),a.timeoutId=setTimeout(function(){e(),d(),G={comunas:!1,etapas:!1,map:!1}},1e3)})}),a.showGroup=function(b){a.selectedGroup!==b&&(F[a.selectedGroup](!0),y.svg.selectAll(".child").style("opacity",0).style("display","none"),y.svg.selectAll("circle.obra").transition().style("opacity",.5),a.selectedGroup=b),D[b]();var c=G[b]||"map"===b?100:2e3;G[b]=!0,setTimeout(function(){E[b](),t()},c)};var I=x.select(null),J=x.select(null),K=x.select(null);a.closeTooltip=function(){a.tooltip.transition().duration(200).style("top",0).style("left",0).style("opacity",0)}}]),angular.module("obrasMduytApp").controller("ObraCtrl",["$scope","DataService","$routeParams",function(a,b,c){a.pymChild=new window.pym.Child({polling:1e3}),a.pymChild.sendHeight(),a.obraId=c.id;var d={url:"//tiles1.usig.buenosaires.gob.ar/mapcache/tms/1.0.0/amba_con_transporte_3857@GoogleMapsCompatible/{z}/{x}/{y}.png",format:"tms",builder:"tms",baseLayer:!0,options:{maxZoom:18,minZoom:9,attribution:'USIG (<a href="http://www.buenosaires.gob.ar" target="_blank">GCBA</a>), © <a href="http://www.openstreetmap.org/copyright/en" target="_blank">OpenStreetMap</a> (ODbL)',tms:!0}};a.titles=d,angular.extend(a,{markers:{},center:{lat:-34.604,lng:-58.382,zoom:15},tiles:d,defaults:{scrollWheelZoom:!1}}),b.getById(c.id).then(function(b){console.log(b),a.obra=b,a.slides=["http://flexslider.woothemes.com/images/kitchen_adventurer_cheesecake_brownie.jpg","http://flexslider.woothemes.com/images/kitchen_adventurer_lemon.jpg","http://flexslider.woothemes.com/images/kitchen_adventurer_donut.jpg","http://flexslider.woothemes.com/images/kitchen_adventurer_caramel.jpg"],angular.extend(a,{markers:{m1:{lat:parseFloat(b.lat),lng:parseFloat(b.lng),focus:!0,message:b.nombre}}})})}]),angular.module("obrasMduytApp").controller("EntornoCtrl",["$scope","DataService","$routeParams",function(a,b,c){a.pymChild=new window.pym.Child({polling:1e3}),a.pymChild.sendHeight(),b.getByEntorno(c.entorno).then(function(b){a.entorno=c.entorno,console.log(b),a.obras=b})}]),angular.module("obrasMduytApp").run(["$templateCache",function(a){a.put("views/entorno.html",'<div class="row"> <div class="col-md-12"> <h1>Entorno: {{entorno}}</h1> <p>Obras: {{obras.length}}</p> <p ng-repeat="obra in obras"> Obra: {{$index+1}} -> {{obra}} </p> </div> </div> <div class="row"> <div class="col-md-12"> <h4>[Galería]</h4> </div> </div> <div class="row"> <div class="col-md-12"> <h4>[Datos]</h4> </div> </div> <div class="row"> <div class="col-md-12"> <h4> Ubicación de Obra </h4> <leaflet lf-center="london" tiles="tiles" markers="markers" defaults="defaults" width="100%" height="350px"></leaflet> </div> </div>'),a.put("views/home.html",'<div class="row"> <div class="col-sm-10"> <div class="row"> <div class="col-sm-12"> <a class="btn btn-default" ng-click="showGroup(\'map\')">Mapa</a> <a class="btn btn-default" ng-click="showGroup(\'comunas\')">Comunas</a> <a class="btn btn-default" ng-click="showGroup(\'etapas\')">Etapas</a> </div> </div> <div class="row"> <div class="col-sm-12"> <div id="home-chart-container"></div> <div id="tooltip-home-chart"> <button type="button" class="close pull-right" ng-click="closeTooltip()">&times;</button> <span class="title">Obra:</span> <span class="desc">{{selectedObra.data.nombre}}</span> <span class="title">Tipo:</span> <span class="desc">{{selectedObra.data.tipo}}</span> <span class="title">Estado:</span> <span class="desc">{{selectedObra.data.etapa}}</span> <a ng-href="{{selectedObra.data.link_interno}}" class="btn btn-default btn-xs btn-block">Más información</a> </div> </div> </div> </div> <div class="col-sm-2"> <h4>Tipos de obra</h4> <div id="side-chart-container"></div> <hr> <h4>Monto total <br> <small>(en milloes de pesos)</small></h4> <div id="scale-chart-container"></div> </div> </div> <div class="row"> <div class="col-md-12"> <h4>[Sankey]</h4> </div> </div>'),a.put("views/obra.html",'<div class="row obra"> <div class="col-md-12"> <h3>Obra {{obra.id}}: {{obra.nombre}}</h3> <div class="row"> <div class="col-md-8"> <flex-slider slide="s in slides" animation="slide" control-nav="thumbnails"> <li data-thumb="{{s}}"> <img ng-src="{{s}}"> </li> </flex-slider> <p> {{obra.descripcion}} </p> </div> <div class="col-md-4 ficha-tecnica"> <h4> Ficha técnica de Licitación </h4> <div class="etapa"> <div class="row"> <div class="col-md-2"> Etapa: </div> <div class="col-md-10"> <p><strong>{{obra.etapa}} </strong> </p> <p> <small> {{obra.etapa_etapa_detalle}}</small> </p> </div> </div> </div> <div> <p> Tipo de Obra: <strong ng-repeat="tipo in obra.tipo">{{tipo}}</strong> </p> </div> <p> Area Responsable: <strong> {{obra.area_responsable}}</strong></p> <p> Empresas <ul> <li ng-repeat="empresa in obra.licitacion_oferta_empresas"> <strong>{{empresa}} <i class="detalle-frame-icon glyphicon glyphicon-info-sign" data-container="body" title="{{nota}}" data-toggle="popover" data-placement="bottom" data-content="Fuente: {{fuente}}"></i> </strong> </li> </ul> </p> <p> Estado </p> <div class="progress"> <div class="progress-bar bg-color-{{obra.slug}}" role="progressbar" ng-style="{ \'width\': obra.porcentaje_avance + \'%\' }"> <div class="progressbar-w" ng-show="!obra.porcentaje_avance"><p></p> </div> <span class="progressbar-w" ng-hide="obra.porcentaje_avance<22 || !obra.porcentaje_avance"> </span> </div> <div class="progress-w" ng-show="obra.porcentaje_avance<22" ng-style="{ \'width\': (100 - obra.porcentaje_avance) + \'%\' }"></div> </div> <p> Plazo total: <strong> {{obra.plazo_meses}} meses </strong> </p> <div class="row fechas"> <div class="col-md-3"> <p> Inicio</p> <p> {{obra.fecha_inicio}} </p> </div> <div class="col-md-6"> <p>-</p> </div> <div class="col-md-3 right"> <p> Fin </p> <p> {{obra.fecha_fin_inicial}} </p> </div> </div> <p ng-if="obra.benficiarios"> Cantidad de Beneficiaros: <strong> {{obra.benficiarios}}</strong> </p> <p ng-if="obra.mano_obra"> Mano de Obra <strong> {{obra.mano_obra}} </strong> </p> <p ng-if="obra.monto_contrato"> Monto Contrato: <strong> {{obra.monto_contrato | currency}} </strong> </p> <p ng-if="obra.licitacion_presupuesto_oficial"> Monto Actualizado: <strong> {{obra.licitacion_presupuesto_oficial | currency}} </strong> </p> <p> <a href=""><i class="detalle-frame-icon glyphicon glyphicon glyphicon-download-alt"> </i> Descargar Informe </a> </p> </div> </div> </div> </div> <div class="row"> <div class="col-md-12"> <h4> Ubicación de Obra </h4> <leaflet center="center" tiles="tiles" markers="markers" defaults="defaults" width="100%" height="350px"></leaflet> </div> </div>')}]);