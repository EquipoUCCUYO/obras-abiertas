"use strict";function fetchId(t){t.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);var e=t.match(/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/);if(null!==e)return e[1]}function getYoutubePic(t){return"https://img.youtube.com/vi/"+fetchId(t)+"/hqdefault.jpg;"}angular.module("obrasMduytApp",["ngRoute","ngSanitize","slugifier","angular-flexslider","leaflet-directive","ngYoutubeEmbed","ngTable"]).config(["$routeProvider","$logProvider","$httpProvider","$locationProvider","$provide","$sceDelegateProvider",function(t,e,a,r,o,n){t.when("/home",{templateUrl:"views/home.html",controller:"HomeCtrl",controllerAs:"home"}).when("/buscador",{templateUrl:"views/buscador.html",controller:"BuscadorCtrl",controllerAs:"buscador"}).when("/obra/:id",{templateUrl:"views/obra.html",controller:"ObraCtrl",controllerAs:"obra"}).when("/entorno/:entorno",{templateUrl:"views/entorno.html",controller:"EntornoCtrl",controllerAs:"entorno"}).when("/obras-bajo-tierra",{templateUrl:"views/obras-bajo-tierra.html",controller:"ObrasBajoTierraCtrl",controllerAs:"ObrasBajoTierra"}).otherwise({redirectTo:"/home"}),e.debugEnabled(!1),r.hashPrefix(""),o.decorator("$locale",["$delegate",function(t){return t.NUMBER_FORMATS.DECIMAL_SEP=",",t.NUMBER_FORMATS.GROUP_SEP=".",t}]),n.resourceUrlWhitelist(["self","*://ws.usig.buenosaires.gob.ar/**"])}]).service("DataService",["$http","$q","Slug","$sce",function(a,o,s,r){var n,i,l=function(t){var e={};for(var a in t)t.hasOwnProperty(a)&&(e[a.toLowerCase()]=t[a]);e.compromiso="SI"==e.compromiso,e.destacada="SI"==e.destacada,e.ba_elige="SI"==e.ba_elige;var r,o,n=e.comuna?e.comuna.split("|"):[null];e.comuna=n[0],e.comuna=e.comuna?parseInt(e.comuna.trim()):e.comuna,e.barrio=e.barrio?e.barrio.split("|"):[],e.licitacion_oferta_empresa=e.licitacion_oferta_empresa?e.licitacion_oferta_empresa:null,e.mano_obra=e.mano_obra?parseInt(e.mano_obra):null,e.id=parseInt(e.id),e.licitacion_anio=e.licitacion_anio?parseInt(e.licitacion_anio.trim()):null,e.monto_contrato=e.monto_contrato?parseFloat(e.monto_contrato.trim()):null,e.licitacion_presupuesto_oficial=e.licitacion_presupuesto_oficial?parseFloat(e.licitacion_presupuesto_oficial.trim()):null,e.plazo_meses=e.plazo_meses?parseInt(e.plazo_meses.trim()):null,e.porcentaje_avance=e.porcentaje_avance?e.porcentaje_avance.trim():"",e.porcentaje_avance.trim(),e.porcentaje_avance=isNaN(e.porcentaje_avance)?"":e.porcentaje_avance,e.porcentaje_avance=e.porcentaje_avance?parseFloat(e.porcentaje_avance):null,e.porcentaje_avance="Finalizada"===e.etapa?100:e.porcentaje_avance,e.hideDates="En proyecto"===e.etapa||"En licitación"===e.etapa,e.fotos=[];for(var i=1;i<=4;i++){e[a="imagen_"+i]&&(e.fotos[i-1]=e[a])}return e.thumb=e.fotos[0]?e.fotos[0]:"",e.slides=e.fotos.map(function(t){return{mode:t.includes("youtu")?"video":"photo",url:t,pic:t.includes("youtu")?getYoutubePic(t):t}}),e.entorno_slug=e.entorno?s.slugify(e.entorno.trim()):null,e.etapa_slug=e.etapa?s.slugify(e.etapa.trim()):null,e.tipo_slug=e.tipo?s.slugify(e.tipo.trim()):null,e.area_slug=e.area_responsable?s.slugify(e.area_responsable.trim()):null,e.red_slug=e.red?s.slugify(e.red.trim()):null,e.monto_slug=e.monto_contrato?(r=e.monto_contrato,o=5e7,_.inRange(r,0,o)?"monto_0_50":_.inRange(r,o,1e8)?"monto_50_100":_.inRange(r,1e8,3*o)?"monto_100_150":"monto_mas_50"):null,e.map=e.lat&&e.lng?"https://maps.googleapis.com/maps/api/staticmap?center="+e.lat+","+e.lng+"&zoom=18&size=300x100&maptype=roadmap&markers=color:blue%7Clabel:%7C"+e.lat+","+e.lng+"&key=AIzaSyBNzIaO8-waiNE1fjdDOAI4TN00ALkOa4o":"",e},e=["en-proyecto","en-licitacion","en-ejecucion","finalizada"],c=function(t){return-1<e.indexOf(t.etapa_slug)},d=function(){window.MDUYT_CONFIG||(console.warn("Archivo de configuración inexistente, utilizando configuración default de desarrollo."),window.MDUYT_CONFIG={BASE_URL:"https://csv-to-api-compromisos.herokuapp.com/",HOME_CSV:"https://goo.gl/vcb6oX",MAPAS_CSV:"https://goo.gl/YYV2E7"},-1<window.location.href.indexOf("dist")?L.Icon.Default.imagePath="/dist/images":L.Icon.Default.imagePath="images")};this.getById=function(e){var a,r=o.defer();return this.retrieveAll().then(function(t){a=t.filter(function(t){return t.id===parseInt(e)}),r.resolve(a[0])}),a=r.promise,o.when(a)},this.getByEntorno=function(e){var a,r=o.defer();return this.retrieveAll().then(function(t){a=t.filter(function(t){return t.entorno_slug===e}),r.resolve(a)}),a=r.promise,o.when(a)},this.getAll=function(){var t,e=o.defer();return this.retrieveAll().then(function(t){e.resolve(t)}),t=e.promise,o.when(t)},this.getMapas=function(){var t,e=o.defer();return this.retrieveMapas().then(function(t){e.resolve(t)}),t=e.promise,o.when(t)},this.retrieveMapas=function(){var t=function(){d();var t="";return window.MDUYT_CONFIG.MAPAS_CSV&&(t=window.MDUYT_CONFIG.BASE_URL+"?source_format=csv&source="+window.MDUYT_CONFIG.MAPAS_CSV),r.trustAsResourceUrl(t)}(),e=o.defer();return""==t&&(i=[]),i||(a.jsonp(t).then(function(t){i=t.data,e.resolve(i)},function(t){console.log("error: ",t),n=t,e.reject(t)}),i=e.promise),o.when(i)},this.retrieveAll=function(){if(!n){var e=o.defer();a.jsonp(function(){d();var t=window.MDUYT_CONFIG.BASE_URL+"?source_format=csv&source="+window.MDUYT_CONFIG.HOME_CSV;return r.trustAsResourceUrl(t)}()).then(function(t){n=t.data.map(l).filter(c),e.resolve(n)},function(t){n=t,e.reject(t)}),n=e.promise}return o.when(n)}}]).filter("capitalize",function(){return function(t){return t?t.charAt(0).toUpperCase()+t.substr(1).toLowerCase():""}}).filter("cleanunderscore",function(){return function(t){return t.replace(/_/g," ")}}).run(function(){}),angular.module("obrasMduytApp").directive("progressLine",function(){return{restrict:"E",replace:!0,scope:{callback:"=callback",class:"=class"},controller:["$scope","$timeout","$http",function(g,t,e){g.loading=!0;var a,r=function(){var t=g.obra,e=moment(t.fecha_inicio),a=moment(t.fecha_fin_inicial),r=moment(),o=d3.scale.linear().domain([0,100]).range([e.valueOf(),a.valueOf()]),n=r.valueOf(),i=parseFloat(t.porcentaje_avance);i<100&&(n=o(i));var s,l,c,d=[{label:"Category 1",value:n}],p=document.querySelectorAll(".chart")[0].clientWidth,u=d3.scale.linear().domain([e.valueOf(),a.valueOf()]).range([0,p]);a.valueOf();d3.select(".chart").html(""),(s=(c=d3.select(".chart").append("svg").attr("width",p).attr("height",55)).selectAll("g").data(d).enter().append("g")).attr("class","bar").attr("cx",0).attr("transform",function(t,e){return"translate(0,"+(5*e+0)+")"}),l=u,d3.svg.axis().scale(l).tickSize(2).orient("bottom"),s.append("rect").attr("transform","translate(0, 15)").attr("height",1).attr("width",function(t){return l(o(100))}),c.append("g").append("text").attr("class","value").attr("y",30).attr("x",0).attr("dx",0).attr("dy","0").attr("text-anchor","start").text("Inicio"),c.append("g").append("text").attr("class","value").attr("y",45).attr("x",0).attr("dx",0).attr("dy","0").attr("text-anchor","start").text(e.format("MM-YYYY")),c.append("g").append("text").attr("class","value").attr("y",30).attr("x",p).attr("dx",0).attr("dy","0").attr("text-anchor","end").text("Fin"),c.append("g").append("text").attr("class","value").attr("y",45).attr("x",p).attr("dx",0).attr("dy","0").attr("text-anchor","end").text(a.format("MM-YYYY"))};g.resizeFunction=r,g.callback(function(t){g.obra=t,setTimeout(r,100)}),$(window).resize(function(){clearTimeout(a),a=setTimeout(function(){g.resizeFunction&&g.resizeFunction()},500)})}],template:'<div class="chart"></div>'}}),angular.module("obrasMduytApp").directive("coloredIcons",function(){return{restrict:"E",replace:!0,scope:{callback:"=callback",scale:"=scale",class:"=class"},controller:["$scope","$element","$timeout","$http",function(i,s,t,e){i.loading=!0;i.scale;i.id="content-"+Math.floor(1e4*Math.random());i.id;i.callback(function(n){s[0].clientWidth;setTimeout(function(){d3.select(s[0]).html("");var t=d3.select(s[0]).append("svg").attr("viewBox","0 0 100 16"),o=t.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("y1","100%").attr("y2","0%").attr("spreadMethod","pad");o.append("svg:stop").attr("offset","0%").attr("stop-color","#f1662f").attr("stop-opacity",1),t.append("defs").append("g").attr("id","iconCustom").append("path").attr("d","M3.5,2H2.7C3,1.8,3.3,1.5,3.3,1.1c0-0.6-0.4-1-1-1c-0.6,0-1,0.4-1,1c0,0.4,0.2,0.7,0.6,0.9H1.1C0.7,2,0.4,2.3,0.4,2.6v1.9c0,0.3,0.3,0.6,0.6,0.6h0.2c0,0,0,0.1,0,0.1v1.9c0,0.3,0.2,0.6,0.3,0.6h1.3c0.2,0,0.3-0.3,0.3-0.6V5.3c0,0,0-0.1,0-0.1h0.2c0.3,0,0.6-0.3,0.6-0.6V2.6C4.1,2.3,3.8,2,3.5,2z"),t.append("rect").attr("width",100).attr("height",10).attr("fill","#efefef");var e=d3.range(22);t.append("text").attr("id","txtValue").attr("x",1).attr("y",15).attr("dy",0).text("Manzana"),t.append("text").attr("id","txtValue").attr("x",30).attr("y",15).attr("dy",0).text("Barrio"),t.append("text").attr("id","txtValue").attr("x",60).attr("y",15).attr("dy",0).text("Comuna"),t.append("text").attr("id","txtValue").attr("x",85.5).attr("y",15).attr("dy",0).text("Ciudad"),t.append("g").attr("id","pictoLayer").selectAll("use").data(e).enter().append("use").attr("xlink:href","#iconCustom").attr("id",function(t){return"icon"+t}).attr("x",function(t){return 2+t%22*4.3}).attr("y",function(t){return 1+4.3*Math.floor(t/22)}).classed("iconPlain",!0);var a=1,r=1;"manoDeObra"===i.scale&&(a=20,r=n.mano_obra),"beneficiarios"===i.scale&&(a=5e4,r=n.benficiarios),function(t){t.percent;var a=t.percent/100*22,r=a%1;d3.selectAll("use").attr("fill",function(t,e){return t<a-1?"#f1662f":a-1<t&&t<a?(o.append("svg:stop").attr("offset",100*r+"%").attr("stop-color","#f1662f").attr("stop-opacity",1),o.append("svg:stop").attr("offset",100*r+"%").attr("stop-color","#aaa").attr("stop-opacity",1),o.append("svg:stop").attr("offset","100%").attr("stop-color","#aaa").attr("stop-opacity",1),"url(#gradient)"):"#aaa"})}({percent:100*r/(22*a)})},300)})}],template:"<div class='colored'></div>"}}),angular.module("obrasMduytApp").directive("selectorHome",function(){return{restrict:"E",scope:{list:"=",updateFn:"&",selectedGroup:"="},template:"<div id='selector-home' class='row' ng-show='selectedGroup'><div ng-repeat='(key, g) in list' class='col-xs-3 selector' ng-class='{\"selectorSelected\":selectedGroup==g.id}'><a ng-click='updateFn({group:g.id})'><img ng-src=\"{{'images/selectores/'+g.id+'.svg'}}\"/><span>{{g.name}}</span></a></div></div>",replace:!0,link:function(t,e,a){}}}),angular.module("obrasMduytApp").directive("statsHome",["$timeout","$interval",function(t,o){return{restrict:"E",scope:{obras:"="},templateUrl:"views/includes/stats-home.html",replace:!0,link:function(a,t,e){var r;a.total={inversion:0,obras:0,finalizadas:0,mano_obra:0,porcentaje_finalizadas:0},a.totalTemp=angular.copy(a.total),a.totalRender=angular.copy(a.total);a.$watch(e.obras,function(t){t&&(r=angular.copy(t),_.map(r,function(t){a.total.obras+=1,t.monto_contrato&&(a.total.inversion+=t.monto_contrato),t.mano_obra&&(a.total.mano_obra+=t.mano_obra),100==t.porcentaje_avance&&(a.total.finalizadas+=1,a.total.porcentaje_finalizadas=Math.round(100*a.total.finalizadas/a.total.obras))}),function(){a.counter_steps=20,a.current_step=0;var t=o(function(){a.counter_steps==a.current_step?o.cancel(t):(angular.forEach(a.total,function(t,e){a.totalTemp[e]=a.totalRender[e]+a.total[e]/a.counter_steps}),a.totalRender=angular.copy(a.totalTemp)),a.current_step++},200)}())})}}}]),angular.module("obrasMduytApp").directive("tipoChart",function(){return{restrict:"E",scope:{labels:"=",obras:"=",filterFn:"&",finishFn:"&",selectedFilter:"=",tipoColors:"="},template:"<div class='row chart-item'><div id='tipo-chart'><div class='col-md-2'><h4>Filtrar por tipo de obra</h4></div></div><div class='col-md-2'><p></p></div><div class='col-md-10 label-slug'><h3></h3></div></div>",replace:!0,link:function(i,t,e){var a,r=!1,s="",o=0;$(window).load(function(){o=$(window).width()});var n={};function l(){n.w=d3.select("#tipo-chart").node().getBoundingClientRect().width,n.margin=n.w/100,n.barh=40,n.gap=10,n.h=i.total_obras_by_tipo.length*(n.barh+n.gap)+2*n.gap,n.tipo_chart_container||(n.tipo_chart_container=d3.select("#tipo-chart").append("div").attr("id","tipo-chart-container").classed("col-md-10",!0),n.groups=n.tipo_chart_container.selectAll("div.tipo-group").data(i.total_obras_by_tipo),n.groups.enter().append("div").attr("id",function(t){return"tipo-group-"+t.slug}).classed("tipo-group",!0).each(function(o){var t=d3.select(this).append("a").datum(o).classed("tipo-container",!0).on("click",function(t){i.filterFn({filter:t.slug}),r?r&&s!=t.slug?($(".label-slug h3").html(i.labels[t.slug]),s=t.slug):r&&s==t.slug&&($(".label-slug h3").html(""),r=!1):($(".label-slug h3").html(i.labels[t.slug]),s=t.slug,r=!0)}),n=t.append("div").classed("image-container",!0);t.append("span").datum(o).classed("tipo-text",!0).attr("fill","#fff").text(function(){return o.tipo}),d3.xml("images/iconos/"+o.slug+".svg",function(t,e){if(t)console.error(t);else{var a=e.getElementsByTagName("svg")[0];n.node().appendChild(a);var r=i.tipoColors(o.tipo);console.log(r,o.tipo),n.select("svg").attr("height",50).attr("width",50).selectAll("path,rect").attr("fill",r)}})})),i.finishFn()}i.$watch(e.obras,function(t){var e;t&&"object"==typeof t&&(a=t,e=_.groupBy(a.filter(function(t){return void 0!==t.tipo}),"tipo"),i.total_obras_by_tipo=_.orderBy(_.reduce(e,function(t,e,a){return t.push({tipo:a,slug:e[0].tipo_slug,cantidad:e.length}),t},[]),"cantidad","desc"),l(),window.$(window).resize(function(){o!=$(window).width()&&(clearTimeout(i.timeoutId),i.timeoutId=setTimeout(function(){l()},1e3))}))}),i.$watch(e.selectedFilter,function(t){n.groups&&function(){if(i.selectedFilter){var t=n.tipo_chart_container.select("#tipo-group-"+i.selectedFilter);t.empty()?n.tipo_chart_container.selectAll(".tipo-group").classed("selected",!1):(n.tipo_chart_container.selectAll(".tipo-group").classed("selected",!1),t.classed("selected",!0))}else n.tipo_chart_container.selectAll(".tipo-group").classed("selected",!1)}()})}}}),angular.module("obrasMduytApp").directive("etapaChart",function(){return{restrict:"E",scope:{obras:"=",filterFn:"&",selectedFilter:"=",tipoColors:"="},template:"<div id='etapa-chart'></div>",replace:!0,link:function(o,t,e){var a,r=0;$(window).load(function(){r=$(window).width()});var n={};function i(){n.w=d3.select("#etapa-chart").node().getBoundingClientRect().width,n.margin=n.w/100,n.barh=40,n.gap=10,n.h=2*n.barh+2*n.gap,n.svg||(n.svg=d3.select("#etapa-chart").append("svg"),n.mainGroup=n.svg.append("g").classed("main-group",!0),n.selection=n.mainGroup.append("rect").classed("selection",!0).attr("height",n.gap+n.barh).attr("x",n.w).attr("y",n.barh).attr("fill","#ffbc00"),n.pipe=n.mainGroup.append("line").classed("pipe",!0).attr("height",n.h).attr("y1",n.barh/2).attr("y2",2*n.barh+2*n.gap).attr("fill","black").attr("stroke","black").attr("stroke-width",1)),n.max=d3.max(o.obras_by_etapa,function(t){return t.cantidad}),n.scale=d3.scale.linear().domain([0,n.max]).range([0,n.w/2-2*n.gap]),n.svg.attr("width",n.w).attr("height",n.h),n.selection.attr("width",n.w/2-n.gap),n.groups=n.mainGroup.selectAll("g.etapa-group").data(o.obras_by_etapa),n.pipe.attr("x1",n.w/2).attr("x2",n.w/2),n.groups.enter().append("g").attr("id",function(t){return"etapa-group-"+t.slug}).classed("etapa-group",!0).each(function(t,e){var a=d3.select(this);t.index=e,_.map(t.obras,function(t){return t.index=e,t}),a.selectAll("rect.etapa-rect").data(t.obras).enter().append("rect").classed("etapa-rect",!0).attr("y",n.barh+n.gap).attr("height",n.barh).attr("fill",function(t){return o.tipoColors(t.tipo)}),a.append("text").datum(t).classed("etapa-text",!0).attr("fill","#000").attr("y",n.barh).text(function(){return t.etapa}).attr("text-anchor",function(){return 0==e?"end":"start"}),a.append("rect").datum(t).classed("click-rect",!0).attr("fill","red").attr("fill-opacity",0).on("click",function(t){o.filterFn({filter:t.slug})})});var r={g0:n.scale(n.max)+n.gap,g1:n.gap};n.groups.selectAll("rect.etapa-rect").attr("width",function(t){return n.scale(t.cantidad)}).attr("x",function(t){var e=t.cantidad,a=0==t.index?Math.abs(n.scale(e)-r["g"+t.index]):n.scale(0)+r["g"+t.index];return r["g"+t.index]=0==t.index?r["g"+t.index]-n.scale(e):r["g"+t.index]+n.scale(e),a}),n.groups.selectAll("text.etapa-text").attr("x",function(t){return 0==t.index?n.w/2-n.gap:n.gap}),n.groups.selectAll("rect.click-rect").attr("width",n.w/2).attr("height",2*n.barh+2*n.gap),n.groups.transition().attr("transform",function(t,e){return"translate("+(0==e?0:n.w/2)+",0)"})}o.$watch(e.obras,function(t){t&&(a=t,o.obras_by_etapa=_.map(_.groupBy(a.filter(function(t){return void 0!==t.etapa}),"etapa"),function(t,e){var a=_.groupBy(t.filter(function(t){return void 0!==t.tipo}),"tipo"),r={slug:t[0].etapa_slug,etapa:t[0].etapa,obras:_.orderBy(_.reduce(a,function(t,e,a){return t.push({tipo:a,slug:e[0].tipo_slug,cantidad:e.length}),t},[]),"cantidad","desc")};return r.cantidad=d3.sum(r.obras,function(t){return t.cantidad}),r}),i())}),o.$watch(e.selectedFilter,function(t){n.groups&&function(){if(o.selectedFilter){var t=n.mainGroup.select("#etapa-group-"+o.selectedFilter);if(t.empty())n.selection.transition().attr("x",n.w);else{var e=d3.transform(t.attr("transform")),a=e.translate[0],r=e.translate[1];n.selection.transition().attr("x",a+n.gap/2).attr("y",r+n.barh+n.gap/2)}}else n.selection.transition().attr("x",n.w)}()}),window.$(window).resize(function(){r!=$(window).width()&&(clearTimeout(o.timeoutId),o.timeoutId=setTimeout(function(){i()},1e3))})}}}),angular.module("obrasMduytApp").directive("areaResponsableChart",function(){return{restrict:"E",scope:{obras:"=",filterFn:"&",selectedFilter:"="},template:"<div id='area-responsable-chart' class='row chart-item'><div class='col-md-2'><h4>Filtrar por área de gobierno</h4></div><div class='col-md-5'><select ng-show='total_obras_by_area' id='areas' class='form-control' ng-model='selected'><option value=''>TODAS</option><option ng-repeat='option in total_obras_by_area' value='{{option.slug}}'>{{option.area}}</option></select></div><div class='col-md-5'><div id='mini-chart' ng-class=\"{'all':selected==''}\"></div><p ng-show='selectedCantidad'>{{selectedCantidad}} obras <span ng-show='selectedCantidad!=total'>({{selectedCantidad*100/total | number:0}}% del total)</span> </p></div></div>",replace:!0,link:function(r,t,e){var a,o=0;$(window).load(function(){o=$(window).width()});var n={};function i(){n.w=d3.select("#area-responsable-chart #mini-chart").node().getBoundingClientRect().width,n.margin=n.w/100,n.barh=27,n.gap=2,n.h=n.barh+2*n.gap,n.svg||(n.svg=d3.select("#area-responsable-chart #mini-chart").append("svg"),n.mainGroup=n.svg.append("g").classed("main-group",!0)),r.total=d3.sum(r.total_obras_by_area,function(t){return t.cantidad}),r.selectedCantidad=r.total,n.scale=d3.scale.linear().domain([0,r.total]).range([0,n.w-(r.total_obras_by_area.length+2*n.gap)]),n.svg.attr("width",n.w).attr("height",n.h),n.groups=n.mainGroup.selectAll("g.area-group").data(r.total_obras_by_area),n.groups.enter().append("g").attr("id",function(t){return"area-group-"+t.slug}).classed("area-group",!0).each(function(t){var e=d3.select(this);e.append("rect").datum(t).classed("area-rect",!0).attr("x",n.gap),e.append("rect").datum(t).classed("click-rect",!0).attr("x",n.gap).on("click",function(t){r.filterFn({filter:t.slug})})}),n.groups.selectAll("rect.area-rect").attr("height",n.barh).attr("width",function(t){return n.scale(t.cantidad)}),n.groups.selectAll("rect.click-rect").attr("height",n.barh).attr("width",function(t){return n.scale(t.cantidad)});var a=0;n.groups.transition().attr("transform",function(t){var e=a;return a=a+n.scale(t.cantidad)+n.scale(n.gap),"translate("+e+",0)"})}r.$watch(e.obras,function(t){t&&(a=t,function(){var t=_.groupBy(a.filter(function(t){return void 0!==t.area_responsable}),"area_responsable");r.total_obras_by_area=_.orderBy(_.reduce(t,function(t,e,a){return t.push({area:a,slug:e[0].area_slug,cantidad:e.length}),t},[]),"cantidad","desc"),r.total_obras_by_area_key=_.groupBy(r.total_obras_by_area,"slug");d3.select("#area-responsable-chart #areas").on("change",function(t){var e=d3.select("#area-responsable-chart #areas").property("value");r.filterFn({filter:e})});i()}())}),r.$watch(e.selectedFilter,function(t){n.groups&&function(){if(n.mainGroup.selectAll(".area-rect").classed("selected",!1),r.total_obras_by_area_key[r.selectedFilter]){r.selected=r.selectedFilter;var t=n.mainGroup.select("#area-group-"+r.selectedFilter).select(".area-rect");t.empty()||t.classed("selected",!0),r.selectedCantidad=r.total_obras_by_area_key[r.selectedFilter][0].cantidad}else r.selected="",r.selectedCantidad=r.total}()}),r.selected="",window.$(window).resize(function(){o!=$(window).width()&&(clearTimeout(r.timeoutId),r.timeoutId=setTimeout(function(){i()},1e3))})}}}),angular.module("ngYoutubeEmbed",[]).directive("ngYoutubeEmbed",[function(){return{restrict:"E",template:'<div ng-bind-html="youtubeEmbedFrame"></div>',scope:{url:"=",playauto:"@playauto",autohide:"@autohide",ccloadpolicy:"@ccloadpolicy",color:"@color",controls:"@controls",disablekb:"@disablekb",end:"@end",fs:"@fs",hl:"@hl",ivloadpolicy:"@ivloadpolicy",playlist:"@playlist",playsinline:"@playsinline",rel:"@rel",showinfo:"@showinfo",start:"@start",theme:"@theme",width:"@width",height:"@height"},controller:["$scope","$sce",function(t,e){var a=t.url;if(void 0!==a){if(t.playlistArray=[],void 0!==t.playlist)for(var r=t.playlist.split(","),o=0;o<r.length;o++)t.playlistArray.push(fetchId(r[o]));var n,i,s,l,c,d,p,u,g,m,f,v,h,b,w;n="true"===t.playauto?1:0,i="true"===t.autohide?1:0,s="true"===t.ccloadpolicy?1:0,l="white"===t.color?"white":"red",c="false"===t.controls?0:1,d="false"===t.disablekb?0:1,p=t.end,u="false"===t.fs?0:1,g=t.hl,"false"===t.ivloadpolicy?0:1,m=t.playlistArray,f="true"===t.playsinline?1:0,v="false"===t.rel?0:1,h="false"===t.showinfo?0:1,b=t.start,w=t.theme;var y="<iframe width="+(void 0!==t.width?t.width:"500px")+" height="+(void 0!==t.height?t.height:"350px")+' src="https://www.youtube.com/embed/'+fetchId(a)+"?autoplay="+n+"&autohide="+i+"&cc_load_policy="+s+"&color="+l+"&controls="+c+"&disablekb="+d+"&end="+p+"&fs="+u+"&hl="+g+"&playlist="+m+"&playsinline="+f+"&rel="+v+"&showinfo="+h+"&start="+b+"&theme="+w+'" frameborder="0" allowfullscreen></iframe>';t.youtubeEmbedFrame=e.trustAsHtml(y)}}]}}]),angular.module("obrasMduytApp").controller("HomeCtrl",["$scope","DataService","$filter","$http","$sce",function(c,t,e,d,p){var u=window.d3;c.loading=!0,c.pymChild=new window.pym.Child({polling:1e3});var g={},l={},a="";u.xml("images/iconos/compromiso.svg",function(t,e){a=e}),c.tipo_colors=function(t){var e=[];return e["Espacio Público"]="#A7C64D",e.Escuelas="#7874B2",e.Salud="#F1AD3C",e.Arquitectura="#38A0D7",e["Hidráulica e Infraestructura"]="#BD3E93",e.Transporte="#E84D00",e.Vivienda="#22B496",e[t]},c.selectedGroup=!1,c.oldGroup="mapa",c.selectedObra=!1;var m={};c.selectedFilter=!1,c.labels={},c.selectTypes=[];var r={label:"-Todas las Obras",slug:""};c.obrasTypeFilter=r,c.selectTypes.push(r),c.selectTypes.push({label:"Espacio Público",slug:"espacio-publico"}),c.selectTypes.push({label:"Escuelas",slug:"escuelas"}),c.selectTypes.push({label:"Salud",slug:"salud"}),c.selectTypes.push({label:"Arquitectura",slug:"arquitectura"}),c.selectTypes.push({label:"Vivienda",slug:"vivienda"}),c.selectTypes.push({label:"Transporte",slug:"transporte"}),c.selectTypes.push({label:"Hidráulica e Infraestructura",slug:"hidraulica-e-infraestructura"}),c.labels["espacio-publico"]="Obras e intervenciones en el espacio público, tales como obras en plazas y parques, en veredas o de regeneración urbana.",c.labels.escuelas="Obras de construcción, refacción o puesta en valor de establecimientos educativos.",c.labels.arquitectura="Obras civiles de reforma, puesta en valor o construcción de edificios.",c.labels.salud="Obras de construcción, remodelación y puesta en valor en hospitales y centros de salud y atención comunitaria..",c.labels.vivienda="Construcción de viviendas nuevas y obras de mejoras en viviendas existentes.",c.labels.transporte="Obras de infraestructura destinadas al transporte público y a la construcción y mantenimiento de las vías de circulación. ",c.labels["hidraulica-e-infraestructura"]="Comprende obras e intervenciones relacionadas con el tratamiento de fluidos (cursos de agua o desagües pluviales), así como obras de equipamiento, redes sanitarias, de gas o electricidad, necesarias para la vida en un entorno urbano.",c.availableGroups=[{id:"mapa",name:"Mapa"},{id:"comunas",name:"Comunas"},{id:"montos",name:"Inversión"},{id:"etapas",name:"Etapas"}],c.selectedRadioDimension="monto_contrato",c.tooltip=u.select("#tooltip-home-chart"),c.pymChild.sendHeight();var o={comunas:x,montos:k,etapas:E,mapa:function(){function e(){c.isSmallDevice&&g.svg.attr("height",g.w),g.mapGroup.selectAll("path.map-item").style("display","block").style("stroke-width",0).transition().duration(1e3).style("stroke-width",3).attr("d",g.mapPath).style("opacity",1),g.mapGroup.selectAll("text.map-text").attr("x",function(t){return g.mapPath.centroid(t)[0]}).attr("y",function(t){return g.mapPath.centroid(t)[1]}).style("opacity",1).style("display","block")}g.mapProjection=u.geo.mercator().center([-58.43992,-34.618]).translate([g.w/2,g.h/2]).scale(240*g.w),g.mapPath=u.geo.path().projection(g.mapProjection),g.mapGroup?e():(g.mapGroup=g.svg.select("#map-group"),g.mapGroup.attr("transform","translate(-10)scale(1)"),u.json("geo/comunas.simple.geojson",function(t){g.mapCentroids={},g.mapFeatures=t.features,f.each(g.mapFeatures,function(t){g.mapCentroids["mapa-comuna-"+t.properties.comuna]=g.mapPath.centroid(t)}),g.mapGroup.selectAll("path.map-item").data(g.mapFeatures).enter().append("path").classed("child",!0).classed("map-item",!0).attr("id",function(t){return"mapa-comuna-"+t.properties.comuna}).classed("shape",!0).on("click",y),g.mapGroup.selectAll("text.map-text").data(g.mapFeatures).enter().append("text").attr("class","map-text").classed("child",!0).attr("text-anchor","middle").attr("x",function(t){return g.mapPath.centroid(t)[0]}).attr("y",function(t){return g.mapPath.centroid(t)[1]}).text(function(t){return t.properties.comuna}),e()}))}},n={comunas:C,montos:F,etapas:P,mapa:function(){l.clusters={},l.clusterPoints={},l.nodesComuna=[],l.nodes=c.obras.filter(function(t){return t.lat&&t.lng}).map(function(t){var e="i"+t.id,a=c.isSmallDevice?1.25:4,r={cluster:e,radius:a,data:t};l.clusters[e]=r;var o=g.mapProjection([parseFloat(t.lng),parseFloat(t.lat)]);return l.clusterPoints[e]={x:o[0],y:o[1],radius:c.isSmallDevice?1.25:4},r}),l.scale=!1}},i={comunas:O,montos:G,etapas:M,mapa:_},s={comunas:!1,montos:!1,etapas:!1,mapa:!1},f=window._,v=0;function h(){g.w=u.select("#home-chart-container").node().getBoundingClientRect().width,g.w=(!g.svg||g.w,g.w),c.isSmallDevice=g.w<700,c.isSmallDevice?(g.w=$(window).width(),g.h=$(window).width()):(g.h=g.w,g.margin=g.w/200),g.svg||(g.svg=u.select("#home-chart-container").append("svg"),g.mainGroup=g.svg.append("g").classed("main-group",!0),g.mainGroup.append("rect").attr("fill","white"),g.svg.append("g").attr("id","comunas-group"),g.svg.append("g").attr("id","map-group"),g.svg.append("g").attr("id","etapas-group"),g.svg.append("g").attr("id","montos-group"),l.group=g.svg.append("g").attr("id","bubbles-group"),l.icons=g.svg.append("g").attr("id","bubbles-icons"),c.isSmallDevice&&u.selectAll("#bubbles-group").style("display","none"),g.selection=g.svg.append("circle").attr("class","selection-cicle").attr("cx",0).attr("cy",0).attr("r",0).style("fill","none").style("stroke","black").style("stroke-width",2)),g.svg.attr("width",g.w).attr("height",g.h),g.mainGroup.select("rect").attr("width",g.w).attr("height",g.h),c.showGroup()}function b(o,n,i){var s=Math.floor(g.w/n),l=0,c=0;o.transition().duration(700).attr("transform",function(t,e){var a=l*n,r=c*i;return l<s-1?l++:o[0].length!==e+1&&(l=0,c++),"translate("+a+","+r+")"})}$(window).load(function(){v=$(window).width()}),t.getAll().then(function(t){c.obras=t,c.selectedGroup="mapa",c.loading=!1,setTimeout(function(){h()},1e3),window.$(window).resize(function(){v!=$(window).width()&&(clearTimeout(c.timeoutId),c.timeoutId=setTimeout(function(){s={comunas:!1,montos:!1,etapas:!1,mapa:!1},h()},1e3))})}),c.textFilter="",c.$watch("textFilter",function(t,e){c.loading||c.filterByText()}),c.filterByText=function(){c.textFilter=$(".text-filter").val(),3<c.textFilter.length&&c.filterBubbles(c.selectedFilter,c.textFilter),0===c.textFilter.length&&c.filterBubbles(c.selectedFilter)},c.filterBubbles=function(t){if(c.selectedFilter==t&&(u.selectAll("circle.obra").style("opacity",1),u.selectAll("g.banderita").style("opacity",1),t=!1),""==t&&""==c.textFilter)u.selectAll("circle.obra").style("opacity",1),u.selectAll("g.banderita").style("opacity",1);else if(""==c.textFilter)u.selectAll("circle.obra").style("opacity",.2),u.selectAll("g.banderita").style("opacity",.2),u.selectAll("circle.obra."+t).style("opacity",1),u.selectAll("g.banderita."+t).style("opacity",1);else{u.selectAll("circle.obra").style("opacity",.2);for(var e=c.textFilter.toLowerCase().split(" "),a=0;a<e.length;a++){var r="";""!=t&&(r+="."+t),r+="."+e[a],u.selectAll("circle.obra"+r).style("opacity",1),u.selectAll("g.banderita"+r).style("opacity",1)}}c.selectedFilter=t,c.closeTooltip(),c.$$phase||c.$apply()},c.changeGroup=function(t){c.selectedGroup=t,c.showGroup()},c.showGroup=function(){c.oldGroup!==c.selectedGroup&&(c.closeTooltip(),i[c.oldGroup](!0),g.svg.selectAll(".child").style("opacity",0).style("display","none"),g.svg.selectAll("circle.obra").transition().style("opacity",.5),c.oldGroup=c.selectedGroup),o[c.selectedGroup]();var t=s[c.selectedGroup]||"mapa"===c.selectedGroup?100:2e3;s[c.selectedGroup]=!0,setTimeout(function(){n[c.selectedGroup](),I()},t)};var w=u.select(null);function y(e){if(c.closeTooltip(),w.node()===this)return _();if(w.classed("active",!1),w=u.select(this).classed("active",!0),c.isSmallDevice)c.$apply(function(){c.showList=!0,c.selectedComuna=e.properties.comuna,c.filteredObras=c.obras.filter(function(t){return t.comuna==e.properties.comuna})});else{var t=g.mapPath.bounds(e),a=t[1][0]-t[0][0],r=t[1][1]-t[0][1],o=(t[0][0]+t[1][0])/2,n=(t[0][1]+t[1][1])/2,i=.9/Math.max(a/g.w,r/g.h),s=[g.w/2-i*o,g.h/2-i*n];g.mapGroup.transition().duration(750).attr("transform","translate("+s+")scale("+i+")"),g.mapGroup.selectAll("path").transition().duration(750).style("stroke-width","1px"),g.selection.transition().duration(750).attr("transform","translate("+s+")scale("+i+")"),l.group.transition().duration(750).attr("transform","translate("+s+")scale("+i+")"),l.icons.transition().duration(750).attr("transform","translate("+s+")scale("+i+")")}}function _(){c.isSmallDevice&&u.selectAll("#bubbles-group").style("display","none"),w.classed("active",!1),w=u.select(null),g.mapGroup.transition().duration(750).attr("transform",""),g.selection.transition().duration(750).attr("transform",""),g.mapGroup.selectAll("path").transition().duration(750).style("stroke-width","3px"),l.icons.transition().duration(750).attr("transform",""),l.group.transition().duration(750).attr("transform","")}function x(t){var a,r,e=u.range(1,16);c.isSmallDevice?(a=g.w,r=g.w,g.svg.attr("height",e.length*g.w),g.mainGroup.select("rect").attr("height",e.length*g.w)):(a=g.h/3,r=g.w/5),g.comunasGroup||(g.comunasGroup=g.svg.select("#comunas-group"),g.comunasGroup.selectAll("g.comunas-item").data(e).enter().append("g").classed("child",!0).classed("comunas-item",!0).style("opacity",0).attr("transform",function(t,e){return"translate("+(g.w/2-r/2)+","+(g.h/2-a/2)+")"}).attr("id",function(t){return"comunas-item-"+t}).each(function(){var t=u.select(this);t.append("rect").classed("comunas-item-frame",!0).on("click",A),t.append("text").classed("comunas-item-text",!0).attr("fill","#000").text(function(t){return"Comuna "+t})})),t||g.comunasGroup.selectAll("g.comunas-item").style("display","block"),g.comunasGroup.selectAll("rect.comunas-item-frame").transition().duration(700).attr("x",g.margin).attr("y",g.margin).attr("height",a-2*g.margin).attr("width",r-2*g.margin),g.comunasGroup.selectAll("text.comunas-item-text").transition().duration(700).attr("x",15).attr("y",25),b(g.comunasGroup.selectAll("g.comunas-item").transition().duration(1e3).style("opacity",1),r,a)}function C(t){l.clusters={},l.clusterPoints={};var o=!!t&&t.replace("comunas-item-",""),e=c.obras.filter(function(t){return!o||o&&parseInt(t.comuna)===parseInt(o)}),a=Math.ceil(u.max(e,function(t){return t[c.selectedRadioDimension]})),r=Math.floor(u.min(e,function(t){return t[c.selectedRadioDimension]}));l.scale=u.scale.linear().domain([parseInt(r),parseInt(a)]).range([10,o?100:50]),l.nodes=e.filter(function(t){return t.comuna&&(!o||o&&parseInt(t.comuna)===parseInt(o))}).map(function(t){var e="c"+t.comuna,a=o?10:5,r={cluster:e,radius:a||10,data:t};return(!l.clusters[e]||a>l.clusters[e].radius)&&(l.clusters[e]=r),r}),u.selectAll("g.comunas-item").each(function(t){var e=u.select(this),a=e.select("rect");l.clusterPoints["c"+t]={x:u.transform(e.attr("transform")).translate[0]+a.attr("width")/2,y:u.transform(e.attr("transform")).translate[1]+a.attr("height")/2,radius:20}})}var T=u.select(null);function A(t){if(!c.isSmallDevice){if(c.closeTooltip(),T.node()===this)return O();T.classed("active",!1);var e=(T=u.select(this).classed("active",!0)).node().parentNode;u.selectAll("g.comunas-item").transition().style("opacity",function(){return this===e?1:0}).each("end",function(){this!==e&&u.select(this).style("display","none")}),T.transition().duration(750).attr("height",g.h-2*g.margin).attr("width",g.w-2*g.margin),u.select(e).transition().duration(750).attr("transform","translate(0,0)").each("end",function(){C(u.select(e).attr("id")),I()})}}function O(t){T.classed("active",!1),T=u.select(null),u.selectAll("g.comunas-item").style("display","block"),x(t),t||setTimeout(function(){C(),I()},2e3)}function k(t){var a,r,e=["monto_0_50","monto_50_100","monto_100_150","monto_mas_50"],o={monto_0_50:"Hasta 50 millones",monto_50_100:"50  a 100 millones",monto_100_150:"100 a 150 millones",monto_mas_50:"Más de 150 millones"};c.isSmallDevice?(a=g.w,r=g.w,g.svg.attr("height",e.length*g.w),g.mainGroup.select("rect").attr("height",e.length*g.w)):(a=g.h/2,r=g.w/2),g.montosGroup||(g.montosGroup=g.svg.select("#montos-group"),g.montosGroup.selectAll("g.montos-item").data(e).enter().append("g").classed("child",!0).classed("montos-item",!0).style("opacity",0).attr("transform",function(t,e){return"translate("+(g.w/2-r/2)+","+(g.h/2-a/2)+")"}).attr("id",function(t){return"montos-item-"+t}).each(function(){var t=u.select(this);t.append("rect").classed("montos-item-frame",!0).on("click",j),t.append("text").classed("montos-item-text",!0).attr("fill","#000").text(function(t){return o[t]})})),t||g.montosGroup.selectAll("g.montos-item").style("display","block"),g.montosGroup.selectAll("rect.montos-item-frame").transition().duration(700).attr("x",g.margin).attr("y",g.margin).attr("height",a-2*g.margin).attr("width",r-2*g.margin),g.montosGroup.selectAll("text.montos-item-text").transition().duration(700).attr("x",15).attr("y",25),b(g.montosGroup.selectAll("g.montos-item").transition().duration(1e3).style("opacity",1),r,a)}function F(t){l.clusters={},l.clusterPoints={};var o=!!t&&t.replace("montos-item-",""),e=c.obras.filter(function(t){return t.monto_contrato&&""!=t.monto_contrato&&(!o||o&&t.monto_slug===o)}),a=Math.ceil(u.max(e,function(t){return t[c.selectedRadioDimension]})),r=Math.floor(u.min(e,function(t){return t[c.selectedRadioDimension]}));l.scale=u.scale.linear().domain([parseInt(r),parseInt(a)]).range([10,o?100:50]),l.nodes=e.map(function(t){var e="m-"+t.monto_slug,a=o?10:5,r={cluster:e,radius:a||10,data:t};return(!l.clusters[e]||a>l.clusters[e].radius)&&(l.clusters[e]=r),r}),o?l.clusterPoints=!1:u.selectAll("g.montos-item").each(function(t){var e=u.select(this),a=e.select("rect");l.clusterPoints["m-"+t]={x:u.transform(e.attr("transform")).translate[0]+a.attr("width")/2,y:u.transform(e.attr("transform")).translate[1]+a.attr("height")/2,radius:10}})}var D=u.select(null);function G(t){D.classed("active",!1),D=u.select(null),u.selectAll("g.montos-item").style("display","block"),k(t),t||setTimeout(function(){F(),I()},2e3)}function j(t){if(!c.isSmallDevice){if(c.closeTooltip(),D.node()===this)return G();D.classed("active",!1);var e=(D=u.select(this).classed("active",!0)).node().parentNode;u.selectAll("g.montos-item").transition().style("opacity",function(){return this===e?1:0}).each("end",function(){this!==e&&u.select(this).style("display","none")}),D.transition().duration(750).attr("height",g.h-2*g.margin).attr("width",g.w-2*g.margin),u.select(e).transition().duration(750).attr("transform","translate(0,0)").each("end",function(){F(u.select(e).attr("id")),I()})}}function E(t){var a,r,e=["en-proyecto","en-licitacion","en-ejecucion","finalizada"],o={"en-proyecto":"En Proyecto","en-licitacion":"En Licitación","en-ejecucion":"En Ejecución",finalizada:"Finalizada"};c.isSmallDevice?(a=g.w,r=g.w,g.svg.attr("height",e.length*g.w),g.mainGroup.select("rect").attr("height",e.length*g.w)):(a=g.h/2,r=g.w/2),g.etapasGroup||(g.etapasGroup=g.svg.select("#etapas-group"),g.etapasGroup.selectAll("g.etapas-item").data(e).enter().append("g").classed("child",!0).classed("etapas-item",!0).style("opacity",0).attr("transform",function(t,e){return"translate("+(g.w/2-r/2)+","+(g.h/2-a/2)+")"}).attr("id",function(t){return"etapas-item-"+t}).each(function(){var t=u.select(this);t.append("rect").classed("etapas-item-frame",!0).on("click",R),t.append("text").classed("etapas-item-text",!0).attr("fill","#000").text(function(t){return o[t]})})),t||g.etapasGroup.selectAll("g.etapas-item").style("display","block"),g.etapasGroup.selectAll("rect.etapas-item-frame").transition().duration(700).attr("x",g.margin).attr("y",g.margin).attr("height",a-2*g.margin).attr("width",r-2*g.margin),g.etapasGroup.selectAll("text.etapas-item-text").transition().duration(700).attr("x",15).attr("y",25),b(g.etapasGroup.selectAll("g.etapas-item").transition().duration(1e3).style("opacity",1),r,a)}function P(t){l.clusters={},l.clusterPoints={},l.nodesEtapas=[];var o=!!t&&t.replace("etapas-item-",""),e=c.obras.filter(function(t){return t.etapa&&""!=t.etapa&&(!o||o&&t.etapa_slug===o)}),a=Math.ceil(u.max(e,function(t){return t[c.selectedRadioDimension]})),r=Math.floor(u.min(e,function(t){return t[c.selectedRadioDimension]}));l.scale=u.scale.linear().domain([parseInt(r),parseInt(a)]).range([10,o?100:50]),l.nodes=e.map(function(t){var e="e-"+t.etapa_slug,a=o?10:5,r={cluster:e,radius:a||10,data:t};return(!l.clusters[e]||a>l.clusters[e].radius)&&(l.clusters[e]=r),r}),o?l.clusterPoints=!1:u.selectAll("g.etapas-item").each(function(t){var e=u.select(this),a=e.select("rect");l.clusterPoints["e-"+t]={x:u.transform(e.attr("transform")).translate[0]+a.attr("width")/2,y:u.transform(e.attr("transform")).translate[1]+a.attr("height")/2,radius:10}})}var S=u.select(null);function M(t){S.classed("active",!1),S=u.select(null),u.selectAll("g.etapas-item").style("display","block"),E(t),t||setTimeout(function(){P(),I()},2e3)}function R(t){if(!c.isSmallDevice){if(c.closeTooltip(),S.node()===this)return M();S.classed("active",!1);var e=(S=u.select(this).classed("active",!0)).node().parentNode;u.selectAll("g.etapas-item").transition().style("opacity",function(){return this===e?1:0}).each("end",function(){this!==e&&u.select(this).style("display","none")}),S.transition().duration(750).attr("height",g.h-2*g.margin).attr("width",g.w-2*g.margin),u.select(e).transition().duration(750).attr("transform","translate(0,0)").each("end",function(){P(u.select(e).attr("id")),I()})}}function B(t,e,a){a.node().innerHTML="<div class='circle-bg'></div>",a.node().appendChild(e);var r=c.tipo_colors(t);a.select("svg").attr("width").replace("px","");var o=a.select("svg").attr("height",50).attr("width",50);a.select(".circle-bg").style("background-color",r),o.selectAll("path,rect").attr("fill","#fff")}function I(){"mapa"!=c.selectedGroup&&l.icons.transition().duration(500).attr("opacity",0),l.force=u.layout.force().nodes(l.nodes).size([g.w,g.h]).gravity(0).charge(function(){return c.isSmallDevice?0:1}).on("tick",U).start().on("end",function(){c.loadedBanderita?"mapa"==c.selectedGroup&&l.icons.attr("opacity",1):(l.circles.filter(function(t){return t.data.destacada}).each(function(a){var t=a.x-9,e=a.y-25;l.icons.append("g").attr("class",function(t){var e=a.data.red_slug?"red "+a.data.red_slug:"";return"banderita  "+(a.data.destacada?"destacada ":"")+" "+a.data.tipo_slug+" "+a.data.area_slug+" "+a.data.etapa_slug+" "+e+" "+a.data.nombre.toLowerCase()}).attr("transform","translate("+t+","+e+") scale(0.25)")}),u.selectAll("g.banderita").append(function(){return a.cloneNode(!0).documentElement}),c.loadedBanderita=!0)}),l.circles=l.group.selectAll("circle.obra").data(l.nodes),c.isSmallDevice||l.circles.enter().append("circle").attr("class",function(t){var e=t.data.red_slug?"red "+t.data.red_slug:"";return"obra  "+(t.data.destacada?" destacada ":"")+" "+t.data.tipo_slug+" "+t.data.area_slug+" "+t.data.etapa_slug+" "+e+" "+t.data.nombre.toLowerCase()}).on("mouseenter",function(a){if("1"==u.select(this).style("opacity")){a.color_tipo_obra=c.tipo_colors(a.data.tipo),c.selectedObra=a,c.tooltipThumb=a.data.thumb,c.$apply();var r=u.select("#tooltip-logo-container");if(!c.selectedObra.map){var t=p.getTrustedResourceUrl("https://ws.usig.buenosaires.gob.ar/geocoder/2.2/reversegeocoding?x="+a.data.lng+"&y="+a.data.lat);d.jsonp(t,{jsonpCallbackParam:"callback"}).then(function(t){c.selectedObra.map="http://servicios.usig.buenosaires.gov.ar/LocDir/mapa.phtml?x="+t.data.puerta_x+"&y="+t.data.puerta_y+"&h=100&w=300&punto=1&r=50"})}m[a.data.tipo_slug]?B(a.data.tipo,m[a.data.tipo_slug],r):u.xml("images/iconos/"+a.data.tipo_slug+".svg",function(t,e){t?console.error(t):(m[a.data.tipo_slug]=e.getElementsByTagName("svg")[0],B(a.data.tipo,m[a.data.tipo_slug],r))});var e=u.select(this);g.selection.attr("cx",e.attr("cx")).attr("cy",e.attr("cy")).attr("r",0).style("stroke",a.color_tipo_obra).transition().duration(500).attr("r",13).style("opacity",1);var o=g.w/2<u.event.pageX?u.event.pageX-320:u.event.pageX,n=parseInt(c.tooltip.style("height").replace("px","")),i=document.body,s=document.documentElement,l=Math.max(i.scrollHeight,i.offsetHeight,s.clientHeight,s.scrollHeight,s.offsetHeight)-600<u.event.pageY?u.event.pageY-n:u.event.pageY;c.tooltip.style("width","300px").transition().duration(200).style("top",l+"px").style("left",o+"px").style("opacity",1)}}).on("mouseout",function(t){}),c.isSmallDevice&&l.circles.enter().append("circle").attr("class",function(t){var e=t.data.red_slug?"red "+t.data.red_slug:"";return"obra "+(t.data.destacada?"destacada ":"")+" "+t.data.tipo_slug+" "+t.data.area_slug+" "+t.data.etapa_slug+" "+e+" "+t.data.nombre.toLowerCase()}).on("click",function(a){if(a.color_tipo_obra=c.tipo_colors(a.data.tipo),c.selectedObra=a,c.tooltipThumb=!1,!c.selectedObra.map){var t=p.getTrustedResourceUrl("https://ws.usig.buenosaires.gob.ar/geocoder/2.2/reversegeocoding?x="+a.data.lng+"&y="+a.data.lat);d.jsonp(t,{jsonpCallbackParam:"callback"}).then(function(t){c.selectedObra.map="http://servicios.usig.buenosaires.gov.ar/LocDir/mapa.phtml?x="+t.data.puerta_x+"&y="+t.data.puerta_y+"&h=100&w=300&punto=1&r=50"})}var r=u.select("#tooltip-logo-container");m[a.data.tipo_slug]?B(a.data.tipo,m[a.data.tipo_slug],r):u.xml("images/iconos/"+a.data.tipo_slug+".svg",function(t,e){t?console.error(t):(m[a.data.tipo_slug]=e.getElementsByTagName("svg")[0],B(a.data.tipo,m[a.data.tipo_slug],r))}),u.selectAll("circle.obra").style("opacity",.3),u.select(this).style("opacity",1),c.tooltip.style("width",g.w-20+"px").transition().duration(200).style("left","10px").style("top",u.event.pageY+"px").style("opacity",1),c.$apply()}),l.circles.attr("id",function(t){return"e"+t.data.id}).attr("class",function(t){var e=t.data.red_slug?"red "+t.data.red_slug:"";return"obra "+(t.data.destacada?"destacada ":"")+" "+t.data.tipo_slug+" "+t.data.area_slug+" "+t.data.etapa_slug+" "+e+" "+t.data.nombre.toLowerCase()}).style("fill",function(t){return c.tipo_colors(t.data.tipo)}),l.circles.transition().style("opacity",1).attr("r",function(t){return t.radius}),l.circles.exit().remove(),c.filterBubbles(c.selectedFilter)}function U(t){var m,e,s;l.circles.each((s=10*t.alpha*t.alpha,function(t){var e=l.clusters[t.cluster],a=1;if(e){e===t&&(a=l.clusterPoints?(e={x:(e=l.clusterPoints[t.cluster]).x,y:e.y,radius:-e.radius},5*Math.sqrt(t.radius)):(e={x:g.w/2,y:g.h/2,radius:-t.radius},Math.sqrt(t.radius)));var r=t.x-e.x,o=t.y-e.y,n=Math.sqrt(r*r+o*o),i=t.radius+e.radius;n!==i&&(n=(n-i)/n*s*a,t.x-=r*=n,t.y-=o*=n,e.x+=r,e.y+=o)}})).each((m=.2,e=u.geom.quadtree(l.nodes),function(c){var t=c.radius+2,d=c.x-t,p=c.x+t,u=c.y-t,g=c.y+t;e.visit(function(t,e,a,r,o){if(t.point&&t.point!==c){var n=c.x-t.point.x,i=c.y-t.point.y,s=Math.sqrt(n*n+i*i),l=c.radius+t.point.radius+2;s<l&&(s=(s-l)/s*m,c.x-=n*=s,c.y-=i*=s,t.point.x+=n,t.point.y+=i)}return p<e||r<d||g<a||o<u})})).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y})}c.loadedBanderita=!1,c.closeTooltip=function(){g.selection.transition().duration(200).attr("r",0).style("opacity",0),c.tooltip.transition().duration(200).style("top","-500px").style("opacity",0)},c.closeList=function(){c.showList=!1,c.filteredObras=[],c.selectedComuna=""}}]),angular.module("obrasMduytApp").controller("ObraCtrl",["$scope","DataService","$routeParams",function(e,t,a){e.loading=!0,e.pymChild=new window.pym.Child({polling:1e3}),e.pymChild.sendHeight(),e.obraId=a.id,e.tipo_colors=function(t){var e=[];return e["Espacio Público"]="#A7C64D",e.Escuelas="#7874B2",e.Salud="#F1AD3C",e.Arquitectura="#38A0D7",e["Hidráulica e Infraestructura"]="#BD3E93",e.Transporte="#E84D00",e.Vivienda="#22B496",e[t]};var r={url:"//tiles1.usig.buenosaires.gob.ar/mapcache/tms/1.0.0/amba_con_transporte_3857@GoogleMapsCompatible/{z}/{x}/{y}.png",format:"tms",builder:"tms",baseLayer:!0,options:{maxZoom:18,minZoom:9,attribution:'USIG (<a href="http://www.buenosaires.gob.ar" target="_blank">GCBA</a>), © <a href="http://www.openstreetmap.org/copyright/en" target="_blank">OpenStreetMap</a> (ODbL)',tms:!0}};e.titles=r,angular.extend(e,{markers:{},center:{lat:-34.604,lng:-58.382,zoom:15},tiles:r,defaults:{scrollWheelZoom:!1}}),e.mainCallback=function(t){e.drawLineOnObraLoaded=t},e.drawFirstColored=function(t){e.firstColoredLoaded=t},e.drawSecondColored=function(t){e.secondColoredLoaded=t},t.getById(a.id).then(function(t){!(e.obra=t).hideDates&&e.drawLineOnObraLoaded&&e.drawLineOnObraLoaded(t),t.beneficiarios&&e.firstColoredLoaded&&e.firstColoredLoaded(t),t.mano_obra&&e.secondColoredLoaded&&e.secondColoredLoaded(t),e.slides=t.fotos.map(function(t){return{mode:t.includes("youtu")?"video":"photo",url:t,pic:t.includes("youtu")?getYoutubePic(t):t}}),angular.extend(e,{center:{lat:parseFloat(t.lat),lng:parseFloat(t.lng),zoom:15},markers:{m1:{lat:parseFloat(t.lat),lng:parseFloat(t.lng),focus:!0,message:t.nombre}}}),e.center.lat=parseFloat(t.lat),e.center.lng=parseFloat(t.lng);t.fecha_inicio,t.fecha_fin_inicial;e.loading=!1})}]),angular.module("obrasMduytApp").controller("EntornoCtrl",["$scope","DataService","$routeParams","leafletData","$timeout",function(s,t,l,c,d){s.loading=!0,s.pymChild=new window.pym.Child({polling:1e3}),s.pymChild.sendHeight();var e={url:"//tiles1.usig.buenosaires.gob.ar/mapcache/tms/1.0.0/amba_con_transporte_3857@GoogleMapsCompatible/{z}/{x}/{y}.png",format:"tms",builder:"tms",baseLayer:!0,options:{maxZoom:18,minZoom:9,attribution:'USIG (<a href="http://www.buenosaires.gob.ar" target="_blank">GCBA</a>), © <a href="http://www.openstreetmap.org/copyright/en" target="_blank">OpenStreetMap</a> (ODbL)',tms:!0}};s.titles=e,angular.extend(s,{markers:{},center:{lat:-34.604,lng:-58.382,zoom:15},tiles:e,defaults:{scrollWheelZoom:!1}}),t.getByEntorno(l.entorno).then(function(t){s.entorno=l.entorno,s.obras=t;for(var e={},a=[],r=0;r<t.length;r++){var o=t[r];if(o.lat&&o.lng){var n={lat:parseFloat(o.lat),lng:parseFloat(o.lng),focus:!0,message:o.nombre};e["m"+r]=n,a.push(L.marker([n.lat,n.lng]))}}var i=new L.featureGroup(a);angular.extend(s,{markers:e}),s.loading=!1,d(function(){c.getMap().then(function(t){t.fitBounds(i.getBounds(),{padding:[50,50]})})},1e3)})}]),angular.module("obrasMduytApp").controller("BuscadorCtrl",["$scope","DataService","$routeParams","NgTableParams","$filter","$sce","ngTableEventsChannel",function(r,t,e,o,a,n,i){r.loading=!0,r.pymChild=new window.pym.Child({polling:1e3}),r.pymChild.sendHeight(),r.montos_string={monto_0_50:"Hasta 50 millones",monto_50_100:"50  a 100 millones",monto_100_150:"100 a 150 millones",monto_mas_50:"Más de 150 millones"},t.getAll().then(function(t){var e={comunas:d3.keys(d3.nest().key(function(t){return t.comuna}).map(t.filter(function(t){return null!==t.comuna}))).map(function(t){return{id:t.trim(),title:"Comuna "+t}}),etapas:d3.keys(d3.nest().key(function(t){return t.etapa}).map(t)).map(function(t){return{id:t,title:t}}),tipos:d3.keys(d3.nest().key(function(t){return t.tipo}).map(t)).map(function(t){return{id:t,title:t}}),montos:d3.keys(d3.nest().key(function(t){return t.monto_slug}).map(t.filter(function(t){return t.monto_slug}))).map(function(t){return{id:t,title:r.montos_string[t]}}),areas:d3.keys(d3.nest().key(function(t){return t.area_responsable}).map(t.filter(function(t){return t.area_responsable}))).map(function(t){return{id:t,title:t}})};function a(t,e){return e[this.field]}e.comunas.unshift({id:"",title:"TODAS"}),e.etapas.unshift({id:"",title:"TODAS"}),e.areas.unshift({id:"",title:"TODAS"}),e.tipos.unshift({id:"",title:"TODOS"}),e.montos.unshift({id:"",title:"TODOS"}),r.cols=[{field:"comuna",title:"Comuna",filter:{comuna:"select"},filterData:e.comunas,show:!0,getValue:a},{field:"nombre",title:"Nombre",filter:{nombre:"text"},show:!0,class:"lupita",getValue:a},{field:"area_responsable",title:"Área Responsable",filter:{area_responsable:"select"},filterData:e.areas,show:!0,getValue:a},{field:"etapa",title:"Etapa",filter:{etapa:"select"},filterData:e.etapas,show:!0,getValue:a},{field:"tipo",title:"Tipo",filter:{tipo:"select"},filterData:e.tipos,show:!0,getValue:a},{field:"monto_slug",title:"Monto Inversión",filter:{monto_slug:"select"},filterData:e.montos,show:!0,getValue:a},{field:"link_interno",title:"",filter:!1,show:!0,getValue:function(t,e){var a=e[this.field],r="";return a&&""!=a&&(r="<a href='"+a+"' class='btn btn-default btn-xs btn-block' target='_blank'>Más información</a>"),n.trustAsHtml(r)}},{field:"licitacion_oferta_empresa",title:"Empresa",filter:{licitacion_oferta_empresa:"text"},show:!0,class:"lupita",getValue:a}],i.onAfterCreated(function(){$('[ng-table-pagination="params"]').appendTo("#footer")},r),i.onAfterReloadData(function(t){r.results=t.data},r),r.tableParams=new o({sorting:{comuna:"asc"},filter:{comuna:"",etapa:"",tipo:"",monto_slug:"",area_responsable:""},page:1,count:10},{dataset:t,counts:[10,25,50]});r.loading=!1,r.timeoutId,window.$(window).resize(function(){clearTimeout(r.timeoutId),r.timeoutId=setTimeout(function(){},1e3)})})}]),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("angular")):"function"==typeof define&&define.amd?define(["angular"],e):"object"==typeof exports?exports["ng-table"]=e(require("angular")):t["ng-table"]=e(t.angular)}(this,function(a){return function(a){function r(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return a[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var o={};return r.m=a,r.c=o,r.i=function(t){return t},r.d=function(t,e,a){Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:a})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=33)}(function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))switch(typeof e[t]){case"function":break;case"object":e[t]=function(t){var r=t.slice(1),o=e[t[0]];return function(t,e,a){o.apply(this,[t,e,a].concat(r))}}(e[t]);break;default:e[t]=e[e[t]]}return e}([function(t,e){t.exports=a},function(t,a,e){var r=e(0),o=e(4),n=e(5),i=e(6),s=e(7),l=e(8),c=e(9),d=e(10),p=e(11),u=e(12),g=e(13),m=e(14),f=e(15),v=e(16),h=e(17);e(25),e(27),e(26),e(28),e(31),e(30),Object.defineProperty(a,"__esModule",{value:!0}),a.default=r.module("ngTable-browser",[]).directive("ngTable",o.ngTable).factory("ngTableColumn",n.ngTableColumn).directive("ngTableColumnsBinding",i.ngTableColumnsBinding).controller("ngTableController",s.ngTableController).directive("ngTableDynamic",l.ngTableDynamic).provider("ngTableFilterConfig",c.ngTableFilterConfigProvider).directive("ngTableFilterRow",d.ngTableFilterRow).controller("ngTableFilterRowController",p.ngTableFilterRowController).directive("ngTableGroupRow",u.ngTableGroupRow).controller("ngTableGroupRowController",g.ngTableGroupRowController).directive("ngTablePagination",m.ngTablePagination).directive("ngTableSelectFilterDs",f.ngTableSelectFilterDs).directive("ngTableSorterRow",v.ngTableSorterRow).controller("ngTableSorterRowController",h.ngTableSorterRowController),function(t){for(var e in t)a.hasOwnProperty(e)||(a[e]=t[e])}(e(18))},function(t,a,e){var r=e(0),o=e(19),n=e(20),i=e(22),s=e(21);Object.defineProperty(a,"__esModule",{value:!0}),a.default=r.module("ngTable-core",[]).provider("ngTableDefaultGetData",o.ngTableDefaultGetDataProvider).value("ngTableDefaults",n.ngTableDefaults).factory("NgTableParams",i.ngTableParamsFactory).factory("ngTableEventsChannel",s.ngTableEventsChannel),function(t){for(var e in t)a.hasOwnProperty(e)||(a[e]=t[e])}(e(23))},,function(t,e,a){function r(t,d){return{restrict:"A",priority:1001,scope:!0,controller:"ngTableController",compile:function(t){var e,s,l=[],c=0,a=[];if(p.forEach(t.find("tr"),function(t){a.push(p.element(t))}),e=a.filter(function(t){return!t.hasClass("ng-table-group")})[0],s=a.filter(function(t){return t.hasClass("ng-table-group")})[0],e)return p.forEach(e.find("td"),function(t){var e,a,r=p.element(t);if(!r.attr("ignore-cell")||"true"!==r.attr("ignore-cell")){var n=function(t){return r.attr("x-data-"+t)||r.attr("data-"+t)||r.attr(t)},o=function(t){var r=n(t);if(r){var o,e=function(t){return void 0!==o?o:d(r)(t)};return e.assign=function(t,e){var a=d(r);a.assign?a.assign(t.$parent,e):o=e},e}},i=n("title-alt")||n("title");i&&r.attr("data-title-text","{{"+i+"}}"),l.push({id:c++,title:o("title"),titleAlt:o("title-alt"),headerTitle:o("header-title"),sortable:o("sortable"),class:o("header-class"),filter:o("filter"),groupable:o("groupable"),headerTemplateURL:o("header"),filterData:o("filter-data"),show:r.attr("ng-if")?o("ng-if"):void 0}),(s||r.attr("ng-if"))&&(e="ng-if",a="$columns["+(l.length-1)+"].show(this)",r.attr("x-data-"+e)?r.attr("x-data-"+e,a):r.attr("data"+e)?r.attr("data"+e,a):r.attr(e,a))}}),function(t,e,a,r){t.$columns=l=r.buildColumns(l),r.setupBindingsToInternalScope(a.ngTable),r.loadFilterData(l),r.compileDirectiveTemplates()}}}}var p=a(0);r.$inject=["$q","$parse"],e.ngTable=r},function(t,e,a){function r(){function a(t){var a=t,e=function t(){return 1!==arguments.length||s(arguments[0])?a:void t.assign(null,arguments[0])};return e.assign=function(t,e){a=e},e}function s(t){return null!=t&&l.isFunction(t.$new)}return{buildColumn:function(r,o,n){var i=Object.create(r),t={class:a(""),filter:a(!1),groupable:a(!1),filterData:l.noop,headerTemplateURL:a(!1),headerTitle:a(""),sortable:a(!1),show:a(!0),title:a(""),titleAlt:a("")};for(var e in t)void 0===i[e]&&(i[e]=t[e]),l.isFunction(i[e])||function(a){var t=function t(){return 1!==arguments.length||s(arguments[0])?r[a]:void t.assign(null,arguments[0])};t.assign=function(t,e){r[a]=e},i[a]=t}(e),function(t){var a=i[t];i[t]=function(){if(1!==arguments.length||s(arguments[0])){var t=arguments[0]||o,e=Object.create(t);return l.extend(e,{$column:i,$columns:n}),a.call(r,e)}a.assign(null,arguments[0])},a.assign&&(i[t].assign=a.assign)}(e);return i}}}var l=a(0);r.$inject=[],e.ngTableColumn=r},function(t,e){function a(o){return{restrict:"A",require:"ngTable",link:function(a,t,e){var r=o(e.ngTableColumnsBinding).assign;r&&a.$watch("$columns",function(t){var e=(t||[]).slice(0);r(a,e)})}}}a.$inject=["$parse"],e.ngTableColumnsBinding=a},function(t,e,a){function r(o,t,a,r,n,i,s,l,c,e){function d(){return!!o.$columns&&function(t,e){for(var a=!1,r=0;r<t.length;r++){var o=t[r];if(e(o)){a=!0;break}}return a}(o.$columns,function(t){return t.show(o)&&!!t.filter(o)})}o.$filterRow={disabled:!1},o.$loading=!1,o.hasOwnProperty("params")||(o.params=new t(!0));var p,u=function(t,e){a.cancel(p),p=a(t,e)};o.$watch("params",function(t,e){t!==e&&t&&t.reload()},!1),o.$watch("params.isDataReloadRequired()",function(t){if(t&&!o.params.hasErrorState()){var e=o.params,a=e.settings().filterOptions;if(e.hasFilterChanges()){var r=function(){e.page(1),e.reload()};a.filterDelay?u(r,a.filterDelay):r()}else e.reload()}}),this.compileDirectiveTemplates=function(){if(!s.hasClass("ng-table")){o.templates={header:i.templateHeader?i.templateHeader:"ng-table/header.html",pagination:i.templatePagination?i.templatePagination:"ng-table/pager.html"},s.addClass("ng-table");var t=null,e=!1;g.forEach(s.children(),function(t){"THEAD"===t.tagName&&(e=!0)}),e||(t=g.element('<thead ng-include="templates.header"></thead>',l),s.prepend(t));var a=g.element('<div ng-table-pagination="params" template-url="templates.pagination"></div>',l);s.after(a),t&&n(t)(o),n(a)(o)}},this.loadFilterData=function(t){g.forEach(t,function(e){var t,a=e.filterData(o);return a?(t=a)&&"object"==typeof t&&"function"==typeof t.then?(delete e.filterData,a.then(function(t){g.isArray(t)||g.isFunction(t)||g.isObject(t)||(t=[]),e.data=t})):e.data=a:void delete e.filterData})},this.buildColumns=function(t){var e=[];return(t||[]).forEach(function(t){e.push(c.buildColumn(t,o,e))}),e},this.parseNgTableDynamicExpr=function(t){if(!t||-1<t.indexOf(" with ")){var e=t.split(/\s+with\s+/);return{tableParams:e[0],columns:e[1]}}throw new Error("Parse error (expected example: ng-table-dynamic='tableParams with cols')")},this.setupBindingsToInternalScope=function(t){o.$watch(t,function(t){void 0!==t&&(o.params=t)},!1),i.showFilter?o.$parent.$watch(i.showFilter,function(t){o.show_filter=t}):o.$watch(d,function(t){o.show_filter=t}),i.disableFilter&&o.$parent.$watch(i.disableFilter,function(t){o.$filterRow.disabled=t}),function(){if(o.$groupRow={show:!1},i.showGroup){var e=r(i.showGroup);o.$parent.$watch(e,function(t){o.$groupRow.show=t}),e.assign&&o.$watch("$groupRow.show",function(t){e.assign(o.$parent,t)})}else o.$watch("params.hasGroup()",function(t){o.$groupRow.show=t})}()},e.onAfterReloadData(function(t,e){var a=(o.$columns||[]).filter(function(t){return t.show(o)});t.hasGroup()?(o.$groups=e||[],o.$groups.visibleColumnCount=a.length):(o.$data=e||[],o.$data.visibleColumnCount=a.length)},o,function(t){return o.params===t}),e.onPagesChanged(function(t,e){o.pages=e},o,function(t){return o.params===t})}var g=a(0);r.$inject=["$scope","NgTableParams","$timeout","$parse","$compile","$attrs","$element","$document","ngTableColumn","ngTableEventsChannel"],e.ngTableController=r},function(t,e,a){function r(){return{restrict:"A",priority:1001,scope:!0,controller:"ngTableController",compile:function(t){var e;if(o.forEach(t.find("tr"),function(t){(t=o.element(t)).hasClass("ng-table-group")||e||(e=t)}),e)return o.forEach(e.find("td"),function(t){var e,a=o.element(t);(e="title",a.attr("x-data-"+e)||a.attr("data-"+e)||a.attr(e))||a.attr("data-title-text","{{$columns[$index].titleAlt(this) || $columns[$index].title(this)}}"),a.attr("ng-if")||a.attr("ng-if","$columns[$index].show(this)")}),function(e,t,a,r){var o=r.parseNgTableDynamicExpr(a.ngTableDynamic);r.setupBindingsToInternalScope(o.tableParams),r.compileDirectiveTemplates(),e.$watchCollection(o.columns,function(t){e.$columns=r.buildColumns(t),r.loadFilterData(e.$columns)})}}}}var o=a(0);r.$inject=[],e.ngTableDynamic=r},function(t,e,a){function r(){function t(){a=r}function e(){var t,r={config:t,getTemplateUrl:function(t,e){var a;return-1!==(a="string"!=typeof t?t.id:t).indexOf("/")?a:r.getUrlForAlias(a,e)},getUrlForAlias:function(t,e){return a.aliasUrls[t]||a.defaultBaseUrl+t+a.defaultExt}};return Object.defineProperty(r,"config",{get:function(){return t=t||o.copy(a)},enumerable:!0}),r}var a,r={defaultBaseUrl:"ng-table/filters/",defaultExt:".html",aliasUrls:{}};this.$get=e,this.resetConfigs=t,this.setConfig=function(t){var e=o.extend({},a,t);e.aliasUrls=o.extend({},a.aliasUrls,t.aliasUrls),a=e},t(),e.$inject=[]}var o=a(0);r.$inject=[],e.ngTableFilterConfigProvider=r},function(t,e,a){function r(){return{restrict:"E",replace:!0,templateUrl:o,scope:!0,controller:"ngTableFilterRowController"}}var o=a(24);r.$inject=[],e.ngTableFilterRow=r},function(t,e){function a(t,e){t.config=e,t.getFilterCellCss=function(t,e){if("horizontal"!==e)return"s12";var a=Object.keys(t).length;return"s"+parseInt((12/a).toString(),10)},t.getFilterPlaceholderValue=function(t,e){return"string"==typeof t?"":t.placeholder}}a.$inject=["$scope","ngTableFilterConfig"],e.ngTableFilterRowController=a},function(t,e,a){function r(){return{restrict:"E",replace:!0,templateUrl:o,scope:!0,controller:"ngTableGroupRowController",controllerAs:"dctrl"}}var o=a(29);r.$inject=[],e.ngTableGroupRow=r},function(t,e){function a(o){function n(e){return o.$columns.filter(function(t){return t.groupable(o)===e})[0]}function t(t){return i(t)?t.title:t.title(o)}function e(){var t=o.$columns.filter(function(t){return!!t.groupable(o)});return d.concat(t)}function a(){return o.$columns.filter(function(t){return t.show(o)})}function r(t){var e;s(t)?(e=o.params.hasGroup(o.$selGroup,"asc")?"desc":o.params.hasGroup(o.$selGroup,"desc")?"":"asc",o.params.group(o.$selGroup,e)):i(t)?o.params.group(t):o.params.group(t.groupable(o))}function i(t){return"function"==typeof t}function s(t){return i(t)?t===o.$selGroup:t.groupable(o)===o.$selGroup}function l(t){var e=n(o.$selGroup);if(e&&e.show.assign&&e.show.assign(o,!0),i(t))d=[t],o.$selGroup=t,o.$selGroupTitle=t.title;else{var a=Object.keys(t||{})[0],r=n(a);r&&(o.$selGroupTitle=r.title(o),o.$selGroup=a,r.show.assign&&r.show.assign(o,!1))}}function c(){return o.params.settings().groupOptions.isExpanded=!o.params.settings().groupOptions.isExpanded,o.params.reload()}var d=[];o.getGroupables=e,o.getGroupTitle=t,o.getVisibleColumns=a,o.groupBy=r,o.isSelectedGroup=s,o.toggleDetail=c,o.$watch("params.group()",l,!0)}a.$inject=["$scope"],e.ngTableGroupRowController=a},function(t,e,a){function r(o,n,t){return{restrict:"A",scope:{params:"=ngTablePagination",templateUrl:"="},replace:!1,link:function(a,r){t.onAfterReloadData(function(t){a.pages=t.generatePagesArray()},a,function(t){return t===a.params}),a.$watch("templateUrl",function(t){if(void 0!==t){var e=i.element('<div ng-include="templateUrl"></div>',n);r.append(e),o(e)(a)}})}}}var i=a(0);r.$inject=["$compile","$document","ngTableEventsChannel"],e.ngTablePagination=r},function(t,e){function a(){return{restrict:"A",controller:r}}function r(a,t,e,r){function o(){var t,e;(t=n,e=t.data,e instanceof Array?r.when(e):r.when(e&&e())).then(function(t){t&&!function(t){for(var e,a=0;a<t.length;a++){var r=t[a];if(r&&""===r.id){e=!0;break}}return e}(t)&&t.unshift({id:"",title:""}),t=t||[],a.$selectData=t})}var n;n=t(e.ngTableSelectFilterDs)(a),a.$watch(function(){return n&&n.data},o)}a.$inject=[],e.ngTableSelectFilterDs=a,r.$inject=["$scope","$parse","$attrs","$q"]},function(t,e,a){function r(){return{restrict:"E",replace:!0,templateUrl:o,scope:!0,controller:"ngTableSorterRowController"}}var o=a(32);r.$inject=[],e.ngTableSorterRow=r},function(t,e){function a(s){s.sortBy=function(t,e){var a=t.sortable&&t.sortable();if(a&&"string"==typeof a){var r=s.params.settings().defaultSort,o="asc"===r?"desc":"asc",n=s.params.sorting()&&s.params.sorting()[a]&&s.params.sorting()[a]===r,i=e.ctrlKey||e.metaKey?s.params.sorting():{};i[a]=n?o:r,s.params.parameters({sorting:i})}}}a.$inject=["$scope"],e.ngTableSorterRowController=a},function(t,e){},function(t,e,a){var u=a(0),r=function(){function t(a){function c(t){var e=t.settings().filterOptions;return u.isFunction(e.filterFn)?e.filterFn:a(e.filterFilterName||r.filterFilterName)}function l(t){return a(r.sortingFilterName)}function d(t,e){var a=t.slice((e.page()-1)*e.count(),e.page()*e.count());return e.total(t.length),a}function t(t,e){if(null==t)return[];var a,r,o,n=u.extend({},p,e.settings().dataOptions),i=n.applyFilter?function(t,e){if(!e.hasFilter())return t;var l=e.filter(!0),a=Object.keys(l).reduce(function(t,e){return a=t,r=l[e],o=e.split("."),n=a,i=o[o.length-1],s=n,o.slice(0,o.length-1).forEach(function(t){s.hasOwnProperty(t)||(s[t]={}),s=s[t]}),s[i]=r,n;var a,r,o,n,i,s},{});return c(e).call(e,t,a,e.settings().filterOptions.filterComparator)}(t,e):t,s=n.applySort?(a=i,r=e.orderBy(),o=l(),r.length?o(a,r):a):i;return n.applyPaging?d(s,e):s}var p={applyFilter:!0,applySort:!0,applyPaging:!0};return t.applyPaging=d,t.getFilterFn=c,t.getOrderByFn=l,t}this.filterFilterName="filter",this.sortingFilterName="orderBy";var r=this;(this.$get=t).$inject=["$filter"]};e.ngTableDefaultGetDataProvider=r},function(t,e){e.ngTableDefaults={params:{},settings:{}}},function(t,e,a){function r(l){function t(t,e){var a,r,o=t.charAt(0).toUpperCase()+t.substring(1),n=((r={})["on"+o]=function(o){function s(e){return e?"function"==typeof e?e:function(t){return t===e}:function(t){return!0}}return function(n,t,e){var i,a,r=l;return i=(a=t)&&"function"==typeof a.$new?(r=t,s(e)):s(t),r.$on("ngTable:"+o,function(t,e){for(var a=[],r=2;r<arguments.length;r++)a[r-2]=arguments[r];if(!e.isNullInstance){var o=[e].concat(a);i.apply(this,o)&&n.apply(this,o)}})}}(t),r["publish"+o]=(a=t,function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];l.$broadcast.apply(l,["ngTable:"+a].concat(t))}),r);return i.extend(e,n)}var e={};return t("pagesChanged",e=t("datasetChanged",e=t("afterReloadData",e=t("afterCreated",e))))}var i=a(0);r.$inject=["$rootScope"],e.ngTableEventsChannel=r},function(t,e,a){function r(y,_,t,x,$,C){return function(t,e){function d(t){return!isNaN(parseFloat(t))&&isFinite(t)}function p(t){var e,a=w.groupOptions&&w.groupOptions.defaultSort;if(t){if(c(t))return null==t.sortDirection&&(t.sortDirection=a),t;if("object"!=typeof t)return(e={})[t]=a,e;for(var r in t)null==t[r]&&(t[r]=a);return t}return t}function l(t){var e=[];for(var a in t)e.push(("asc"===t[a]?"+":"-")+a);return e}function o(){var t=b.group;return{params:b,groupSortDirection:c(t)?t.sortDirection:void 0}}function c(t){return"function"==typeof t}function a(){var t=b.filter&&b.filter.$,e=i&&i.params.filter&&i.params.filter.$;return!T.equals(t,e)}function n(t){return(w.interceptors||[]).reduce(function(t,e){var a=e.response&&e.response.bind(e)||y.when,r=e.responseError&&e.responseError.bind(e)||y.reject;return t.then(function(t){return a(t,u)},function(t){return r(t,u)})},t)}"boolean"==typeof t&&(this.isNullInstance=!0);var i,s,r,u=this,g=!1,m=[],f=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];w.debugMode&&_.debug&&_.debug.apply(_,t)},v={filterComparator:void 0,filterDelay:500,filterDelayThreshold:1e4,filterFilterName:void 0,filterFn:void 0,filterLayout:"stack"},h={getData:function(t){return $(t.settings().dataset,t)},getGroups:function(o){var n,t=o.group(),i=void 0;if(c(t))i=(n=t).sortDirection;else{var e=Object.keys(t)[0];i=t[e],n=function(t){return function t(e,a){var r;if(r="string"==typeof a?a.split("."):a,void 0!==e){if(0===r.length)return e;if(null!==e)return t(e[r[0]],r.slice(1))}}(t,e)}}var s=o.settings(),a=s.dataOptions;s.dataOptions={applyPaging:!1};var r=s.getData;return y.when(r(o)).then(function(t){var a={};T.forEach(t,function(t){var e=n(t);a[e]=a[e]||{data:[],$hideRows:!s.groupOptions.isExpanded,value:e},a[e].data.push(t)});var e=[];for(var r in a)e.push(a[r]);return i&&(e=$.getOrderByFn()(e,l({value:i}))),$.applyPaging(e,o)}).finally(function(){s.dataOptions=a})}};this.data=[],this.parameters=function(t,e){if(e=e||!1,void 0===typeof t)return b;for(var a in t){var r=t[a];if(e&&0<=a.indexOf("[")){for(var o=a.split(/\[(.*)\]/).reverse(),n="",i=0,s=o.length;i<s;i++){var l=o[i];if(""!==l){var c=r;(r={})[n=l]=d(c)?parseFloat(c):c}}"sorting"===n&&(b[n]={}),b[n]=T.extend(b[n]||{},r[n])}else b[a]="group"===a?p(t[a]):d(t[a])?parseFloat(t[a]):t[a]}return f("ngTable: set parameters",b),this},this.settings=function(t){if(T.isDefined(t)){t.filterOptions&&(t.filterOptions=T.extend({},w.filterOptions,t.filterOptions)),t.groupOptions&&(t.groupOptions=T.extend({},w.groupOptions,t.groupOptions)),T.isArray(t.dataset)&&(t.total=t.dataset.length);var e=w.dataset;if(w=T.extend(w,t),T.isArray(t.dataset)&&w.filterOptions.filterDelay===v.filterDelay&&w.total<=w.filterOptions.filterDelayThreshold&&w.getData===h.getData&&(w.filterOptions.filterDelay=0),t.hasOwnProperty("dataset")&&t.dataset!=e){g&&this.page(1),g=!1;var a=function(){C.publishDatasetChanged(u,t.dataset,e)};m?m.push(a):a()}return f("ngTable: set settings",w),this}return w},this.page=function(t){return void 0!==t?this.parameters({page:t}):b.page},this.total=function(t){return void 0!==t?this.settings({total:t}):w.total},this.count=function(t){return void 0!==t?this.parameters({count:t,page:1}):b.count},this.filter=function(t){if(null!=t&&"object"==typeof t)return this.parameters({filter:t,page:1});if(!0!==t)return b.filter;for(var e=Object.keys(b.filter),a={},r=0;r<e.length;r++){var o=b.filter[e[r]];null!=o&&""!==o&&(a[e[r]]=o)}return a},this.group=function(t,e){if(void 0===t)return b.group;var a,r={page:1};return c(t)&&void 0!==e?(t.sortDirection=e,r.group=t):r.group="string"==typeof t&&void 0!==e?((a={})[t]=e,a):t,this.parameters(r),this},this.sorting=function(t,e){return"string"==typeof t&&void 0!==e?(this.parameters({sorting:(a={},a[t]=e,a)}),this):void 0!==t?this.parameters({sorting:t}):b.sorting;var a},this.isSortBy=function(t,e){return void 0!==e?void 0!==b.sorting[t]&&b.sorting[t]==e:void 0!==b.sorting[t]},this.orderBy=function(){return l(b.sorting)},this.generatePagesArray=function(t,e,a,r){var o,n,i,s;arguments.length||(t=this.page(),e=this.total(),a=this.count()),r=r&&r<6?6:r;var l=[];if(1<(s=Math.ceil(e/a))){l.push({type:"prev",number:Math.max(1,t-1),active:1<t}),l.push({type:"first",number:1,active:1<t,current:1===t}),n=Math.round((w.paginationMaxBlocks-w.paginationMinBlocks)/2),i=Math.max(2,t-n),o=Math.min(s-1,t+2*n-(t-i));for(var c=i=Math.max(2,i-(2*n-(o-i)));c<=o;)c===i&&2!==c||c===o&&c!==s-1?l.push({type:"more",active:!1}):l.push({type:"page",number:c,active:t!==c,current:t===c}),c++;l.push({type:"last",number:s,active:t!==s,current:t===s}),l.push({type:"next",number:Math.min(s,t+1),active:t<s})}return l},this.isDataReloadRequired=function(){return!g||!T.equals(o(),i)||a()},this.hasFilter=function(){return 0<Object.keys(this.filter(!0)).length},this.hasGroup=function(t,e){return null==t?c(b.group)||0<Object.keys(b.group).length:c(t)?null==e?b.group===t:b.group===t&&t.sortDirection===e:null==e?-1!==Object.keys(b.group).indexOf(t):b.group[t]===e},this.hasFilterChanges=function(){var t=i&&i.params.filter;return!T.equals(b.filter,t)||a()},this.url=function(a){function t(t,e){a?r.push(e+"="+encodeURIComponent(t)):r[e]=encodeURIComponent(t)}function e(t,e){return"group"===e||void 0!==typeof t&&""!==t}var r=(a=a||!1)?[]:{};for(var o in b)if(b.hasOwnProperty(o)){var n=b[o],i=encodeURIComponent(o);if("object"==typeof n){for(var s in n)if(e(n[s],o)){var l=i+"["+encodeURIComponent(s)+"]";t(n[s],l)}}else!T.isFunction(n)&&e(n,o)&&t(n,i)}return r},this.reload=function(){var e=this,t=null;if(w.$loading=!0,i=T.copy(o()),g=!0,e.hasGroup())t=n(y.when(w.getGroups(e)));else{var a=w.getData;t=n(y.when(a(e)))}f("ngTable: reload data");var r=e.data;return t.then(function(t){return w.$loading=!1,s=null,e.data=t,C.publishAfterReloadData(e,t,r),e.reloadPages(),t}).catch(function(t){return s=i,y.reject(t)})},this.hasErrorState=function(){return!(!s||!T.equals(s,o()))},this.reloadPages=function(){var t=r,e=u.generatePagesArray(u.page(),u.total(),u.count());T.equals(t,e)||(r=e,C.publishPagesChanged(this,e,t))};var b={page:1,count:10,filter:{},sorting:{},group:{}};T.extend(b,x.params);var w={$loading:!1,dataset:null,total:0,defaultSort:"desc",filterOptions:T.copy(v),groupOptions:T.copy({defaultSort:"asc",isExpanded:!0}),counts:[10,25,50,100],interceptors:[],paginationMaxBlocks:11,paginationMinBlocks:5,sortingIndicator:"span"};return this.settings(h),this.settings(x.settings),this.settings(e),this.parameters(t,!0),C.publishAfterCreated(this),T.forEach(m,function(t){t()}),m=null,this}}var T=a(0);r.$inject=["$q","$log","$filter","ngTableDefaults","ngTableDefaultGetData","ngTableEventsChannel"],e.ngTableParamsFactory=r},18,function(t,e,a){var r="ng-table/filterRow.html";a(0).module("ng").run(["$templateCache",function(t){t.put(r,'<tr ng-show=show_filter class=ng-table-filters> <th data-title-text="{{$column.titleAlt(this) || $column.title(this)}}" ng-repeat="$column in $columns" ng-if=$column.show(this) class="filter {{$column.class(this)}}" ng-class="params.settings().filterOptions.filterLayout === \'horizontal\' ? \'filter-horizontal\' : \'\'"> <div ng-repeat="(name, filter) in $column.filter(this)" ng-include=config.getTemplateUrl(filter) class=filter-cell ng-class="[getFilterCellCss($column.filter(this), params.settings().filterOptions.filterLayout), $last ? \'last\' : \'\']"> </div> </th> </tr> ')}]),t.exports=r},function(t,e,a){var r="ng-table/filters/number.html";a(0).module("ng").run(["$templateCache",function(t){t.put(r,'<input type=number name={{name}} ng-disabled=$filterRow.disabled ng-model=params.filter()[name] class="input-filter form-control" placeholder="{{getFilterPlaceholderValue(filter, name)}}"/> ')}]),t.exports=r},function(t,e,a){var r="ng-table/filters/select-multiple.html";a(0).module("ng").run(["$templateCache",function(t){t.put(r,'<select ng-options="data.id as data.title for data in $column.data" ng-disabled=$filterRow.disabled multiple=multiple ng-multiple=true ng-model=params.filter()[name] class="filter filter-select-multiple form-control" name={{name}}> </select> ')}]),t.exports=r},function(t,e,a){var r="ng-table/filters/select.html";a(0).module("ng").run(["$templateCache",function(t){t.put(r,'<select ng-options="data.id as data.title for data in $selectData" ng-table-select-filter-ds=$column ng-disabled=$filterRow.disabled ng-model=params.filter()[name] class="filter filter-select form-control" name={{name}}> <option style=display:none value=""></option> </select> ')}]),t.exports=r},function(t,e,a){var r="ng-table/filters/text.html";a(0).module("ng").run(["$templateCache",function(t){t.put(r,'<input type=text name={{name}} ng-disabled=$filterRow.disabled ng-model=params.filter()[name] class="input-filter form-control" placeholder="{{getFilterPlaceholderValue(filter, name)}}"/> ')}]),t.exports=r},function(t,e,a){var r="ng-table/groupRow.html";a(0).module("ng").run(["$templateCache",function(t){t.put(r,'<tr ng-if=params.hasGroup() ng-show=$groupRow.show class=ng-table-group-header> <th colspan={{getVisibleColumns().length}} class=sortable ng-class="{\n                    \'sort-asc\': params.hasGroup($selGroup, \'asc\'),\n                    \'sort-desc\':params.hasGroup($selGroup, \'desc\')\n                  }"> <a href="" ng-click="isSelectorOpen = !isSelectorOpen" class=ng-table-group-selector> <strong class=sort-indicator>{{$selGroupTitle}}</strong> <button class="btn btn-default btn-xs ng-table-group-close" ng-click="$groupRow.show = false; $event.preventDefault(); $event.stopPropagation();"> <span class="glyphicon glyphicon-remove"></span> </button> <button class="btn btn-default btn-xs ng-table-group-toggle" ng-click="toggleDetail(); $event.preventDefault(); $event.stopPropagation();"> <span class=glyphicon ng-class="{\n                    \'glyphicon-resize-small\': params.settings().groupOptions.isExpanded,\n                    \'glyphicon-resize-full\': !params.settings().groupOptions.isExpanded\n                }"></span> </button> </a> <div class=list-group ng-if=isSelectorOpen> <a href="" class=list-group-item ng-repeat="group in getGroupables()" ng-click=groupBy(group)> <strong>{{ getGroupTitle(group)}}</strong> <strong ng-class="isSelectedGroup(group) && \'sort-indicator\'"></strong> </a> </div> </th> </tr> ')}]),t.exports=r},function(t,e,a){var r="ng-table/header.html";a(0).module("ng").run(["$templateCache",function(t){t.put(r,"<ng-table-group-row></ng-table-group-row> <ng-table-sorter-row></ng-table-sorter-row> <ng-table-filter-row></ng-table-filter-row> ")}]),t.exports=r},function(t,e,a){var r="ng-table/pager.html";a(0).module("ng").run(["$templateCache",function(t){t.put(r,'<div class="ng-cloak ng-table-pager" ng-if=params.data.length> <div ng-if=params.settings().counts.length class="ng-table-counts btn-group pull-right"> <button ng-repeat="count in params.settings().counts" type=button ng-class="{\'active\':params.count() == count}" ng-click=params.count(count) class="btn btn-default"> <span ng-bind=count></span> </button> </div> <ul ng-if=pages.length class="pagination ng-table-pagination"> <li ng-class="{\'disabled\': !page.active && !page.current, \'active\': page.current}" ng-repeat="page in pages" ng-switch=page.type> <a ng-switch-when=prev ng-click=params.page(page.number) href="">&laquo;</a> <a ng-switch-when=first ng-click=params.page(page.number) href=""><span ng-bind=page.number></span></a> <a ng-switch-when=page ng-click=params.page(page.number) href=""><span ng-bind=page.number></span></a> <a ng-switch-when=more ng-click=params.page(page.number) href="">&#8230;</a> <a ng-switch-when=last ng-click=params.page(page.number) href=""><span ng-bind=page.number></span></a> <a ng-switch-when=next ng-click=params.page(page.number) href="">&raquo;</a> </li> </ul> </div> ')}]),t.exports=r},function(t,e,a){var r="ng-table/sorterRow.html";a(0).module("ng").run(["$templateCache",function(t){t.put(r,"<tr class=ng-table-sort-header> <th title={{$column.headerTitle(this)}} ng-repeat=\"$column in $columns\" ng-class=\"{\n                    'sortable': $column.sortable(this),\n                    'sort-asc': params.sorting()[$column.sortable(this)]=='asc',\n                    'sort-desc': params.sorting()[$column.sortable(this)]=='desc'\n                  }\" ng-click=\"sortBy($column, $event)\" ng-if=$column.show(this) ng-init=\"template = $column.headerTemplateURL(this)\" class=\"header {{$column.class(this)}}\"> <div ng-if=!template class=ng-table-header ng-class=\"{'sort-indicator': params.settings().sortingIndicator == 'div'}\"> <span ng-bind=$column.title(this) ng-class=\"{'sort-indicator': params.settings().sortingIndicator == 'span'}\"></span> </div> <div ng-if=template ng-include=template></div> </th> </tr> ")}]),t.exports=r},function(t,a,e){function r(t){for(var e in t)a.hasOwnProperty(e)||(a[e]=t[e])}var o=e(0),n=e(2),i=e(1),s=o.module("ngTable",[n.default.name,i.default.name]);a.ngTable=s,r(e(2)),r(e(1))}]))}),angular.module("obrasMduytApp").controller("ObrasBajoTierraCtrl",["$scope","DataService",function(e,t){e.loading=!0,e.pymChild=new window.pym.Child({polling:1e3}),e.pymChild.sendHeight(),t.getAll().then(function(t){console.log(t),e.loading=!1})}]),angular.module("obrasMduytApp").run(["$templateCache",function(t){t.put("views/buscador.html",'<div ng-show="loading" class="row"> <div class="col-sm-12"> <h1 id="loading" class="text-center">Cargando obras</h1> <p class="text-center"><img src="images/loader.75526f36.gif"></p> <hr> </div> </div> <div ng-if="!loading"> <div class="row"> <table id="buscador-table" ng-table-dynamic="tableParams with cols" class="table table-responsive"> <tr ng-repeat="row in $data"> </tr> </table> </div> <div class="row"> <h2 ng-show="results.length==0" class="text-center">No hay resultados para los filtros aplicados</h2> <div class="col-sm-12 well resultado-buscador" ng-repeat="o in results"> <div class="row"> <div class="col-sm-3"> <img ng-show="o.imagen_1" ng-src="{{o.imagen_1}}" class="img-responsive"> <img ng-hide="o.imagen_1" ng-src="http://placehold.it/400x300" class="img-responsive"> </div> <div class="col-sm-9"> <div class="row"> <div class="col-sm-6"> <span class="title">Obra:</span> <span class="desc">{{o.nombre}}</span> </div> <div class="col-sm-3"> <span class="title">Empresa:</span> <span class="desc">{{o.licitacion_oferta_empresa}}</span> </div> <div class="col-sm-3"> <span class="title">Monto inversión:</span> <span class="desc">{{o.monto_contrato | currency}}</span> </div> </div> <div class="row"> <div class="col-sm-12"> <span class="title">Descripción:</span> <span class="desc">{{o.descripcion}}</span> </div> </div> <div class="row"> <div class="col-sm-2"> <span class="title">Área Responsable:</span> <span class="desc">{{o.area_responsable}}</span> </div> <div class="col-sm-2"> <span class="title">Tipo:</span> <span class="desc">{{o.tipo}}</span> </div> <div class="col-sm-2"> <span class="title">Comuna:</span> <span class="desc">Comuna {{o.comuna}}</span> </div> <div class="col-sm-2"> <span class="title">Etapa:</span> <span class="desc">{{o.etapa}}</span> </div> <div class="col-sm-3 col-sm-offset-1"> <a ng-show="o.link_interno" ng-href="{{o.link_interno}}" target="_parent" class="btn btn-default btn-block">Más información</a> </div> </div> </div> </div> </div> </div> <div class="row"> <div id="footer" class="col-sm-12"> </div> </div> </div> '),t.put("views/directives/youtubePlayer.html",'<div class="detalle-frame {{class}}"> <p class="detalle-frame-title text-left" ng-if="title">{{title}} </p> <i ng-if="nota || fuente" class="detalle-frame-icon glyphicon glyphicon-info-sign" data-container="body" title="{{nota}}" data-toggle="popover" data-placement="bottom" data-content="Fuente: {{fuente}}"> </i> <span ng-show="loading">Cargando...</span> <a class="yt-switch" href="javascript:;" ng-click="ytSwitch=true;" ng-hide="ytSwitch" ng-style="{\'background-image\':\'url(\'+ytThumbnail+\')\'}"> <img class="img-responsive" src="images/play.png"> </a> <ng-youtube-embed ng-if="ytSwitch" url="url" playauto="true" color="white" disablekb="true" width="100%" height="300px" rel="false" theme="light" modestbranding="1"> </ng-youtube-embed> </div> '),t.put("views/entorno.html",'<div ng-show="loading" class="row"> <div class="col-sm-12"> <h1 id="loading" class="text-center">Cargando obras</h1> <p class="text-center"><img src="images/loader.75526f36.gif"></p> <hr> </div> </div> <div ng-if="!loading"> <div class="row"> <div class="col-md-12"> <h2>Entorno: {{obras[0].entorno}}</h2> <div ng-repeat="obra in obras"> \x3c!-- Obra: {{$index+1}} -> {{obra}} --\x3e <div ng-include="\'views/includes/obra-detail.html\'"></div> </div> </div> </div> <div class="row"> <div class="col-md-12"> <h4> Ubicación en el Mapa </h4> <leaflet center="center" tiles="tiles" markers="markers" defaults="defaults" width="100%" height="350px"></leaflet> </div> </div> </div> '),t.put("views/home.html",'<div ng-show="loading" class="row"> <div class="col-sm-12"> <h1 id="loading" class="text-center">Cargando obras</h1> <p class="text-center"><img src="images/loader.75526f36.gif"></p> <hr> </div> </div> <div ng-if="!loading"> <div class="row"> <div class="col-sm-12"> <stats-home obras="obras"></stats-home> </div> </div> <div class="hidden-xs"> <selector-home list="availableGroups" selected-group="selectedGroup" update-fn="changeGroup(group)"></selector-home> </div> <div class="row hidden-xs"> <div class="col-sm-12"> <tipo-chart labels="labels" obras="obras" selected-filter="selectedFilter" filter-fn="filterBubbles(filter)" tipo-colors="tipo_colors" finish-fn="tipoChartFinished()"></tipo-chart> </div> </div> <div class="row hidden-xs"> <div class="col-sm-12"> <area-responsable-chart obras="obras" selected-filter="selectedFilter" filter-fn="filterBubbles(filter)"></area-responsable-chart> </div> </div> <div class="row"> <div class="col-sm-12"> <h1 class="hidden-xs"> <strong> Conocé las obras de tu comuna </strong></h1> <h1 class="visible-xs"> <strong> Tocá una comuna para conocer las obras </strong></h1> </div> </div> <div class="row hidden-xs"> <div class="col-md-12"> <div id="search-box" class="row chart-item"> <div class="col-md-2 hidden-xs"> <h4> Buscar por </h4> </div> <div class="col-xs-12 col-md-8 search"> <input ng-model="textFilter" ng-change="filterByText()" class="form-control text-filter" type="text" placeholder="Filtra por nombre o descripcion de obra"> </div> </div> </div> </div> <div id="main-chart-container" class="row"> <div class="hidden-xs col-sm-12"> <a ng-click="filterBubbles(\'destacada\')" class="btn btn btn-secondary btn-sm show-destacadas"><i class="glyphicon glyphicon-flag"></i> Ver Obras Destacadas</a> <p> </p> <p> </p> </div> </div> <div class="col-sm-12 home-chart-main"> <div id="home-chart-container"></div> </div> </div> <div id="mobile-filler" class="row"> </div>  \x3c!-- Tooltip OBRAS --\x3e <div id="tooltip-home-chart"> <button type="button" class="close pull-right" ng-click="closeTooltip()">&times;</button> <div class="row"> <div class="col-xs-12"> <div id="tooltip-logo-container" class="pull-left"></div> <div class="tooltip-title"> <span class="type" ng-style="{color: selectedObra.color_tipo_obra}">{{selectedObra.data.tipo}}</span> <span class="title">{{selectedObra.data.nombre}}</span> </div> </div> </div> <div class="tooltip-img" ng-show="tooltipThumb"> <img class="obra-pic img-responsive" ng-src="{{tooltipThumb}}"> </div> <div class="row"> <div class="col-xs-12"> <div ng-show="selectedObra.data.porcentaje_avance" class="progress"> <span class="desc">{{selectedObra.data.etapa}}<span ng-show="selectedObra.data.porcentaje_avance">: {{selectedObra.data.porcentaje_avance}}%</span></span> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': selectedObra.data.porcentaje_avance + \'%\' }"> <i ng-show="selectedObra.data.porcentaje_avance == 100" class="glyphicon glyphicon-ok"></i> </div> <div class="progress-w" ng-show="selectedObra.data.porcentaje_avance<22" ng-style="{ \'width\': (100 - selectedObra.data.porcentaje_avance) + \'%\' }"></div> </div> </div> </div> <div class="hidden-xs"> <div class="row tooltip-text" ng-show="selectedObra.data.area_responsable"> <div class="col-xs-2"> <img src="images/iconos/ministerio.svg"> </div> <div class="col-xs-10"> <p class="tooltip-text">{{selectedObra.data.area_responsable}}</p> </div> </div> <p class="tooltip-text tooltip-map"> <span class="tooltip-map-loading" ng-show="!selectedObra.map"><small>Cargando mapa</small></span> <span class="tooltip-map-placeholder"> <img class="obra-pic img-responsive" ng-show="selectedObra.map" ng-src="{{selectedObra.map}}"> </span> </p> <div class="row tooltip-text" ng-show="selectedObra.data.direccion"> <div class="col-xs-2"> <img src="images/iconos/location.svg"> </div> <div class="col-xs-10"> <p class="tooltip-text">{{selectedObra.data.direccion}}<br>Comuna {{selectedObra.data.comuna}}</p> </div> </div> </div> <p class="tooltip-text" ng-show="selectedObra.data.link_interno"><a target="_parent" ng-href="{{selectedObra.data.link_interno}}" class="btn btn-link btn-xs btn-block btn-ver-mas">VER MÁS</a></p> <div class="row compromiso-row" ng-show="selectedObra.data.compromiso"> <div class="col-xs-12"> <span class="label label-primary">Compromiso de Gobierno</span> </div> </div> </div> <div ng-show="showList" class="row obra-list open-big"> <div class="grey-back col-xs-12"> <div class="row"> <h4 class="col-xs-10">Obras Comuna {{selectedComuna}}</h4> <h4 class="col-xs-2 right"><a href="" ng-click="closeList()"> <span class="ba-icon ba-no form-control-feedback"></span></a> </h4> </div> </div> <div class="light-grey-back col-xs-12"> <div class="row"> <div class="col-xs-2"> <p>Filtrar:</p> </div> <div class="col-xs-8"> <select class="input" ng-options="item as item.label for item in selectTypes track by item.slug" ng-model="obrasTypeFilter"></select> </div> </div> <div class="row"> <div class="col-xs-2"> <p></p> </div> <div class="col-xs-8"> <input ng-model="obrasListFilter" type="text" placeholder="Palabra Clave"><p></p> </div> </div> </div> <div class="detail col-xs-12" ng-repeat="o in filteredObras | filter:obrasListFilter || obrasTypeFilter.slug"> <div class="row full"> <div class="col-xs-4"> <img class="obra-pic img-responsive" ng-src="{{o.thumb}}"> </div> <div class="col-xs-8"> <div class="row"> <h5> {{o.nombre}} </h5> <p> {{o.descripcion | limitTo:250}}</p> <div class="row data"> <div class="col-xs-6 smaller"> <div class="row"> <div class="col-xs-5"><p>Monto:</p></div> <div class="col-xs-7"> {{o.monto_contrato | currency}}</div> </div> <div class="row"> <div class="col-xs-5"><p>Etapa:</p></div> <div class="col-xs-7">{{o.etapa}}</div> </div> </div> <div class="col-xs-6"> <p class="tooltip-text right" ng-show="o.link_interno"><a target="_parent" ng-href="{{o.link_interno}}" class="btn btn-link btn-xs btn-block btn-ver-mas">VER MÁS</a></p> </div> </div> </div> </div> </div> </div></div>'),t.put("views/includes/obra-detail.html",'<div class="row obra"> <div class="col-md-12"> <h3>Obra: {{obra.nombre}}</h3> <div class="row"> <div class="col-md-8"> <ul> <flex-slider slide="s in obra.slides track by s.url" animation="slide" control-nav="thumbnails"> <li data-thumb="{{s.pic}}" ng-switch="s.mode"> <div ng-switch-when="video"> <ng-youtube-embed url="s.url" playauto="true" color="white" disablekb="true" width="100%" rel="false" theme="light" modestbranding="1"> </ng-youtube-embed> </div> <img ng-switch-default ng-src="{{s.pic}}"> </li> </flex-slider> </ul> <p> {{obra.descripcion}} </p> </div> <div class="col-md-3 ficha-tecnica"> <h4> Ficha técnica</h4> <p class="etiquetas"> <a href="http://www.buenosaires.gob.ar/compromisos" target="_blank>"><span ng-show="obra.compromiso" class="label label-primary compromiso-row compromiso"> <img src="images/iconos/compromiso.svg">Compromiso de Gobierno</span></a> <span ng-show="obra.destacada" class="label label-primary compromiso-row destacada"> <img src="images/iconos/archivo.svg">Obra Destacada</span> <a href="https://baelige.buenosaires.gob.ar/" target="_blank>"> <span ng-show="obra.ba_elige" class="label label-primary compromiso-row ba-elige"> <img src="images/iconos/archivo.svg">BA Elige</span></a> </p> <div class="etapa"> <div class="row"> <div class="col-md-2"> <img src="images/iconos/calendario.svg"> </div> <div class="col-md-10"> <p>Etapa:</p> <p><strong>{{obra.etapa}}</strong> </p> <div class="progress"> <div class="progress-bar bg-color-{{obra.slug}}" role="progressbar" ng-style="{ \'width\': obra.porcentaje_avance + \'%\' }"> <div class="progressbar-w" ng-show="!obra.porcentaje_avance"><p></p> </div> <span class="progressbar-w" ng-hide="obra.porcentaje_avance<22 || !obra.porcentaje_avance"> </span> </div> <div class="progress-w" ng-show="obra.porcentaje_avance<22" ng-style="{ \'width\': (100 - obra.porcentaje_avance) + \'%\' }"></div> </div> <div ng-if="!obra.hideDates" class="row fechas" ng-show="obra.fecha_inicio"> <div class="col-md-6" ng-show="obra.fecha_inicio"> <p> Inicio: <strong>{{obra.fecha_inicio}}</strong></p> </div> <div class="col-md-6" ng-show="obra.fecha_fin"> <p> Fin: <strong>{{obra.fecha_fin}}</strong> </p> </div> </div> </div> </div> <div class="row"> <div class="col-md-2"> <p> </p> </div> <div class="col-md-10"> <p> <small> {{obra.etapa_detalle}}</small> </p> </div> </div> </div> <div class="row"> <div class="col-md-2"> <img src="images/iconos/estilo.svg"> </div> <div class="col-md-10"> <p> Tipo de obra: </p> <strong>{{obra.tipo}}</strong> </div> </div> <div class="row"> <div class="col-md-2"> <img src="images/iconos/ministerio.svg"> </div> <div class="col-md-10"> <p> Área responsable: </p> <strong> {{obra.area_responsable}}</strong> </div> </div> <div class="row" ng-show="obra.licitacion_oferta_empresa"> <div class="col-md-2"> <img src="images/iconos/trabajador.svg"> </div> <div class="col-md-10"> <p> Empresa: </p> <strong> {{obra.licitacion_oferta_empresa}}</strong> <div ng-show="obra.cuit_contratista"> <p> CUIT Empresa: </p> <strong> {{obra.cuit_contratista}}</strong> </div> <div ng-show="obra.contratacion_tipo"> <p> Tipo de contratación: </p> <strong> {{obra.contratista_tipo}}</strong> </div> <div ng-show="obra.nro_contratacion"> <p> N° de contratación: </p> <strong> {{obra.nro_contratacion}}</strong> </div> </div> </div> <div class="row" ng-show="obra.plazo_meses"> <div class="col-md-2"> <img src="images/iconos/relojarena.svg"> </div> <div class="col-md-10"> <p> Plazo total: </p> <strong> {{obra.plazo_meses}} meses </strong> </div> </div> <div class="row" ng-show="obra.hideDates && obra.licitacion_anio"> <div class="col-md-2"> <img src="images/iconos/calendario.svg"> </div> <div class="col-md-10"> <p> Año de licitación: </p> <strong> {{obra.licitacion_anio}}</strong> </div> </div> <div class="row" ng-show="obra.beneficiarios"> <div class="col-md-2"> <img src="images/iconos/ministerio.svg"> </div> <div class="col-md-10"> <p> Cantidad de Beneficiaros:</p> <strong> {{obra.benficiarios}}<small> personas</small> </strong> </div> </div> <div class="row" ng-show="obra.beneficiarios"> <div class="col-md-2"> <img src="images/iconos/ministerio.svg"> </div> <div class="col-md-10"> <p> Mano de Obra: </p> <strong> {{obra.mano_obra}} <small>personas</small> </strong> </div> </div> <div class="row" ng-show="obra.beneficiarios"> <div class="col-md-2"> <img src="images/iconos/trabajador.svg"> </div> <div class="col-md-10"> <p> Mano de Obra: </p> <strong> {{obra.mano_obra}} <small>personas</small> </strong> </div> </div> <div class="row" ng-show="obra.monto_contrato"> <div class="col-md-2"> <img src="images/iconos/dinero.svg"> </div> <div class="col-md-10"> <p>Monto Contrato: </p> <strong> {{obra.monto_contrato | currency}} </strong> </div> </div> <div class="row" ng-show="obra.direccion"> <div class="col-md-2"> <img src="images/iconos/location.svg"> </div> <div class="col-md-10"> <p> Dirección: </p> <strong> {{obra.direccion}} </strong> </div> </div> <div class="row" ng-show="obra.licitacion_presupuesto_oficial"> <div class="col-md-2"> <img src="images/iconos/dinero.svg"> </div> <div class="col-md-10"> <p> Monto Actualizado: </p> <strong> {{obra.licitacion_presupuesto_oficial | currency}} </strong> </div> </div> <div class="row" ng-show="obra.financiamiento"> <div class="col-md-2"> <img src="images/iconos/dinero.svg"> </div> <div class="col-md-10"> <p>Financiador:</p> <strong>{{obra.financiamiento}}</strong> </div> </div> <div class="row" ng-show="obra.pliego_descarga"> <div class="col-md-2"> <img src="images/iconos/archivo.svg"> </div> <div class="col-md-10"> <p><a ng-href="{{obra.pliego_descarga}}" target="_blank">Información de la contratación</a> </p> </div> </div> <div class="row" ng-show="obra.estudio_ambiental_descarga"> <div class="col-md-2"> <img src="images/iconos/archivo.svg"> </div> <div class="col-md-10"> <p><a ng-href="{{obra.estudio_ambiental_descarga}}" target="_blank">Evaluación de impacto ambiental</a> </p> </div> </div> </div> </div> </div> </div> '),t.put("views/includes/stats-home.html",'<div> <div class="row" ng-show="obras"> <div class="col-xs-12"> <h1 class="center"> Observatorio de Obras de la Ciudad </h1> </div> </div> <div id="stats-home" class="row" ng-show="obras"> <div class="col-xs-12"> <div class="row"> <div class="col-xs-6"> <div class="row"> <div class="col-xs-3 col-md-4 icon-container"> <img class="" src="images/indicadores/inversion.svg"> </div> <div class="col-xs-9 col-md-8 value-container"> <h5>Total de inversión:</h5> <span class="value">{{totalRender.inversion | currency:$ :0}}</span> </div> </div> </div> <div class="col-xs-6"> <div class="row"> <div class="col-xs-3 col-md-4 icon-container"> <img class="" src="images/indicadores/obras.svg"> </div> <div class="col-xs-9 col-md-8 value-container"> <h5>Total de obras:</h5> <span class="value">{{totalRender.obras | number:0}}</span> </div> </div> </div> </div> <div class="row"> <div class="col-xs-6"> <div class="row"> <div class="col-xs-3 col-md-4 icon-container"> <img class="" src="images/indicadores/finalizadas.svg"> </div> <div class="col-xs-9 col-md-8 value-container"> <h5>Finalizadas:</h5> <span class="value">{{totalRender.porcentaje_finalizadas | number:0}}%</span> </div> </div> </div> <div class="col-xs-6"> <div class="row"> <div class="col-xs-3 col-md-4 icon-container"> <img class="" src="images/indicadores/personas.svg"> </div> <div class="col-xs-9 col-md-8 value-container"> <h5>Empleados:</h5> <span class="value">{{totalRender.mano_obra | number:0}}</span> </div> </div> </div> </div> </div> </div> </div>'),t.put("views/includes/youtubePlayer.html",'<div class="detalle-frame {{class}}"> <p class="detalle-frame-title text-left" ng-if="title">{{title}} </p> <i ng-if="nota || fuente" class="detalle-frame-icon glyphicon glyphicon-info-sign" data-container="body" title="{{nota}}" data-toggle="popover" data-placement="bottom" data-content="Fuente: {{fuente}}"> </i> <span ng-show="loading">Cargando...</span> <a class="yt-switch" href="javascript:;" ng-click="ytSwitch=true;" ng-hide="ytSwitch" ng-style="{\'background-image\':\'url(\'+ytThumbnail+\')\'}"> <img class="img-responsive" src="images/play.png"> </a> <ng-youtube-embed ng-if="ytSwitch" url="url" playauto="true" color="white" disablekb="true" width="100%" height="300px" rel="false" theme="light" modestbranding="1"> </ng-youtube-embed> </div> '),t.put("views/obra.html",'<div ng-show="loading" class="row"> <div class="col-sm-12"> <h1 id="loading" class="text-center">Cargando obra</h1> <p class="text-center"><img src="images/loader.75526f36.gif"></p> <hr> </div> </div> <div ng-if="!loading"> <div class="row obra"> <div class="col-xs-12"> <div class="row"> <div class="col-xs-12"> <div class="tooltip-title"> <div class="row"> <div class="col-xs-1"> <div class="inner"> <div id="tooltip-logo-container" class="icon pull-left" ng-style="{\'background-color\': tipo_colors(obra.tipo)}"> <img ng-src="images/iconos/{{obra.tipo_slug}}.svg"> </div> </div> </div> <div class="col-xs-10"> <p class="type" ng-style="{color: tipo_colors(obra.tipo)}">{{obra.tipo}}</p> <h3 class="title">{{obra.nombre}}</h3> </div> </div> </div> </div> </div> <div class="row"> <div class="col-md-8"> <ul> <flex-slider slide="s in obra.slides track by s.url" animation="slide" control-nav="thumbnails"> <li data-thumb="{{s.pic}}" ng-switch="s.mode"> <div ng-switch-when="video"> <ng-youtube-embed url="s.url" playauto="true" color="white" disablekb="true" width="100%" rel="false" theme="light" modestbranding="1"> </ng-youtube-embed> </div> <img ng-switch-default ng-src="{{s.pic}}"> </li> </flex-slider> </ul> <p> {{c.descripcion}} </p> </div> <div class="col-md-3 ficha-tecnica"> <h4> Ficha técnica</h4> <p class="etiquetas"> <a href="http://www.buenosaires.gob.ar/compromisos" target="_blank>"><span ng-show="obra.compromiso" class="label label-primary compromiso-row compromiso"> <img src="images/iconos/compromiso.svg">Compromiso de Gobierno</span></a> <span ng-show="obra.destacada" class="label label-primary compromiso-row destacada"> <img src="images/iconos/archivo.svg">Obra Destacada</span> <a href="https://baelige.buenosaires.gob.ar/" target="_blank>"> <span ng-show="obra.ba_elige" class="label label-primary compromiso-row ba-elige"> <img src="images/iconos/archivo.svg">BA Elige</span></a> </p> <div class="etapa"> <div class="row"> <div class="col-md-2"> <img src="images/iconos/calendario.svg"> </div> <div class="col-md-10"> <p>Etapa:</p> <p><strong>{{obra.etapa}}</strong> </p> <div class="progress"> <div class="progress-bar bg-color-{{obra.slug}}" role="progressbar" ng-style="{ \'width\': obra.porcentaje_avance + \'%\' }"> <div class="progressbar-w" ng-show="!obra.porcentaje_avance"> <p></p> </div> <span class="progressbar-w" ng-hide="obra.porcentaje_avance<22 || !obra.porcentaje_avance"></span> </div> <div class="progress-w" ng-show="obra.porcentaje_avance<22" ng-style="{ \'width\': (100 - obra.porcentaje_avance) + \'%\' }"> </div> </div> <div ng-if="!obra.hideDates" class="row fechas" ng-show="obra.fecha_inicio"> <div class="col-md-6" ng-show="obra.fecha_inicio"> <p> Inicio: <strong>{{obra.fecha_inicio}}</strong></p> </div> <div class="col-md-6" ng-show="obra.fecha_fin"> <p> Fin: <strong>{{obra.fecha_fin}}</strong> </p> </div> </div> </div> </div> <div class="row"> <div class="col-md-2"> <p> </p> </div> <div class="col-md-10"> <p> <small> {{obra.etapa_detalle}}</small> </p> </div> </div> <div class="row"> <div class="col-md-2"> <img src="images/iconos/estilo.svg"> </div> <div class="col-md-10"> <p> Tipo de obra: </p> <strong>{{obra.tipo}}</strong> </div> </div> <div class="row"> <div class="col-md-2"> <img src="images/iconos/ministerio.svg"> </div> <div class="col-md-10"> <p> Área responsable: </p> <strong> {{obra.area_responsable}}</strong> </div> </div> <div class="row" ng-show="obra.licitacion_oferta_empresa"> <div class="col-md-2"> <img src="images/iconos/trabajador.svg"> </div> <div class="col-md-10"> <p> Empresa: </p> <strong> {{obra.licitacion_oferta_empresa}}</strong> <div ng-show="obra.cuit_contratista"> <p> CUIT Empresa: </p> <strong> {{obra.cuit_contratista}}</strong> </div> <div ng-show="obra.contratacion_tipo"> <p> Tipo de contratación: </p> <strong> {{obra.contratista_tipo}}</strong> </div> <div ng-show="obra.nro_contratacion"> <p> N° de contratación: </p> <strong> {{obra.nro_contratacion}}</strong> </div> </div> </div> <div class="row" ng-show="obra.plazo_meses"> <div class="col-md-2"> <img src="images/iconos/relojarena.svg"> </div> <div class="col-md-10"> <p> Plazo total: </p> <strong> {{obra.plazo_meses}} meses </strong> </div> </div> <div class="row" ng-show="obra.hideDates && obra.licitacion_anio"> <div class="col-md-2"> <img src="images/iconos/calendario.svg"> </div> <div class="col-md-10"> <p> Año de licitación: </p> <strong> {{obra.licitacion_anio}}</strong> </div> </div> <div class="row" ng-show="obra.beneficiarios"> <div class="col-md-2"> <img src="images/iconos/ministerio.svg"> </div> <div class="col-md-10"> <p> Cantidad de Beneficiaros:</p> <strong> {{obra.benficiarios}}<small> personas</small> </strong> </div> </div> <div class="row" ng-show="obra.beneficiarios"> <div class="col-md-2"> <img src="images/iconos/ministerio.svg"> </div> <div class="col-md-10"> <p> Mano de Obra: </p> <strong> {{obra.mano_obra}} <small>personas</small> </strong> </div> </div> <div class="row" ng-show="obra.beneficiarios"> <div class="col-md-2"> <img src="images/iconos/trabajador.svg"> </div> <div class="col-md-10"> <p> Mano de Obra: </p> <strong> {{obra.mano_obra}} <small>personas</small> </strong> <colored-icons scale="\'manoDeObra\'" callback="drawSecondColored"></colored-icons> </div> </div> <div class="row" ng-show="obra.monto_contrato"> <div class="col-md-2"> <img src="images/iconos/dinero.svg"> </div> <div class="col-md-10"> <p> Monto Contrato: </p> <strong> {{obra.monto_contrato | currency}} </strong> </div> </div> <div class="row" ng-show="obra.direccion"> <div class="col-md-2"> <img src="images/iconos/location.svg"> </div> <div class="col-md-10"> <p> Dirección: </p> <strong> {{obra.direccion}} </strong> </div> </div> <div class="row" ng-show="obra.licitacion_presupuesto_oficial"> <div class="col-md-2"> <img src="images/iconos/dinero.svg"> </div> <div class="col-md-10"> <p> Monto Actualizado: </p> <strong> {{obra.licitacion_presupuesto_oficial | currency}} </strong> </div> </div> <div class="row" ng-show="obra.financiamiento"> <div class="col-md-2"> <img src="images/iconos/dinero.svg"> </div> <div class="col-md-10"> <p>Financiador:</p> <strong>{{obra.financiamiento}}</strong> </div> </div> <div class="row" ng-show="obra.pliego_descarga"> <div class="col-md-2"> <img src="images/iconos/archivo.svg"> </div> <div class="col-md-10"> <p><a ng-href="{{obra.pliego_descarga}}" target="_blank">Información de la contratación</a> </p> </div> </div> <div class="row" ng-show="obra.estudio_ambiental_descarga"> <div class="col-md-2"> <img src="images/iconos/archivo.svg"> </div> <div class="col-md-10"> <p><a ng-href="{{obra.estudio_ambiental_descarga}}" target="_blank">Evaluación de impacto ambiental</a> </p> </div> </div> </div> \x3c!-- etapa --\x3e </div> \x3c!-- ficha técnica --\x3e </div> \x3c!-- row --\x3e <div class="row"> <div class="col-md-12"> <h4> Ubicación de obra </h4> <leaflet center="center" tiles="tiles" markers="markers" defaults="defaults" width="100%" height="350px"></leaflet> </div> </div> </div>\x3c!-- col md 12 --\x3e </div>\x3c!-- row obra --\x3e </div>\x3c!-- if loading --\x3e '),t.put("views/obras-bajo-tierra.html",'<div id="obras-bajo-tierra"> <div ng-show="loading" class="row"> <div class="col-sm-12"> <h1 id="loading" class="text-center">Cargando obras</h1> <p class="text-center"><img src="images/loader.75526f36.gif"></p> <hr> </div> </div> <div ng-if="!loading"> <div class="row"> <h1 class="text-center">Obras bajo tierra VIZ</h1> </div> </div> </div> ')}]);